{"version":3,"sources":["components/common/FitModal.js","components/common/Field.js","components/common/Form.js","utils/timeouts.js","utils/format.js","components/CPU/BreakpointModal.js","utils/clipboard.js","components/CPU/DisasmContextMenu.js","components/CPU/DisasmBranchGuide.js","utils/dom.js","components/CPU/BreakpointIcon.js","components/CPU/DisasmLine.js","components/CPU/DisasmList.js","components/CPU/DisasmSearch.js","components/CPU/StatusBar.js","utils/listeners.js","components/CPU/Disasm.js","components/CPU/DisasmButtons.js","components/CPU/GotoBox.js","components/CPU/FuncList.js","components/CPU/RegList.js","components/CPU/RegPanel.js","components/CPU/VisualizeVFPU.js","components/CPU/LeftPanel.js","components/CPU.js","components/GPU.js","components/LogItem.js","components/Log.js","components/NotConnected.js","sdk/ppsspp.js","assets/logo.svg","components/App.js","registerServiceWorker.js","index.js"],"names":["FitModal","handleRequestClose","props","confirmClose","window","confirm","onClose","className","overlayClassName","onRequestClose","this","closeTimeoutMS","PureComponent","Field","handleChange","ev","onChange","component","target","prop","dataset","value","type","checked","setState","label","children","htmlFor","fieldID","renderInput","renderText","renderHex","renderRadio","renderCheckboxes","other","primary","fieldValue","id","pattern","title","options","map","option","name","disabled","state","displayName","constructor","undefined","Component","Form","action","classNames","onSubmit","heading","Buttons","saveHandler","onSave","saveButton","onClick","cancelButton","onCancel","propTypes","PropTypes","oneOfType","func","bool","node","Timeout","ms","cancel","handle","setTimeout","clearTimeout","toString08X","val","toString","toUpperCase","substr","typeOptions","operationOptions","actionOptions","BreakpointModal","cleanState","isOpen","derivedBreakpoint","cleanBreakpoint","address","size","condition","logFormat","read","write","change","enabled","log","e","operation","ppsspp","send","event","thread","currentThread","expression","breakpoint","then","deleteOld","saveNew","updateExisting","err","alert","message","preventDefault","uintValue","getEvent","cleanTimeout","start","Object","assign","initialOverrides","editing","contentLabel","hasChanges","renderMemory","renderExecute","Fragment","compareTo","keys","find","key","prevProps","prevState","runEarly","Error","nextProps","userInitiated","listeners","getScratchpad","div","document","getElementById","createElement","style","width","height","opacity","position","top","left","pointerEvents","whiteSpace","body","appendChild","createScratchpad","copyText","text","scratchpad","textContent","textNode","firstChild","range","createRange","setStart","setEnd","length","selection","getSelection","oldRange","rangeCount","getRangeAt","removeAllRanges","addRange","execCommand","prompt","hasClosestMatch","selector","matches","parentNode","Element","prototype","msMatchesSelector","addEventListener","collapsed","listener","activeElement","result","handler","test","navigator","platform","clipboardData","setData","replace","DisasmContextMenu","handleCopyAddress","data","line","focus","handleCopyHex","getSelectedLines","macroEncoding","join","encoding","handleCopyDisasm","getSelectedDisasm","handleAssemble","assembleInstruction","catch","handleRunUntil","handleJumpPC","handleToggleBreakpoint","toggleBreakpoint","handleFollowBranch","followBranch","handleTodo","console","trigger","stepping","branch","relevantData","divider","connectMenu","DisasmBranchGuide","pos","calcPos","lineHeight","classes","selected","xmlns","d","buildPath","guide","yCenter","Math","floor","trailingEdge","sourceEdge","arrowEdge","path","push","direction","bottom","end","findAddressOffset","right","lane","down","off","offsets","isSubsetBounds","bounds","parentBounds","ensureInView","windowBounds","innerHeight","innerWidth","rect","getBoundingClientRect","HTMLElement","getComputedStyle","overflows","overflow","overflowX","overflowY","indexOf","isInView","scrollIntoView","contextMenuStatus","hasContextMenu","BreakpointIcon","viewBox","DisasmLine","ref","React","createRef","focused","cursor","isCurrentPC","mapData","current","attributes","onDoubleClick","tabIndex","contextmenu","renderTag","collect","holdToDisplay","backgroundColor","data-address","renderAddress","highlight","params","highlightParams","renderConditional","symbol","addressHex","displaySymbols","conditionMet","before","after","fullText","toLowerCase","matchLength","beforeLength","split","toHighlight","param","includes","button","needsScroll","triggerNode","block","lineNode","querySelector","DisasmList","mouseDown","lineOffsets","pendingLineParams","selectedLineParams","prevLines","prevSelectionTop","prevSelectionBottom","onCopy","cursorRef","focusTimeout","paramsTimeout","events","onMouseDownCapture","onMouseDown","onMouseUpCapture","onMouseUp","onMouseMove","onKeyDown","onBlur","onFocusChange","onFocus","lines","renderLine","branchGuides","renderBranchGuide","isLineSelected","shouldHighlight","highlightText","shouldHighlightParams","String","match","parts","some","part","addressBoundingTop","filter","l","update","reset","mouseEventToLine","updateCursor","applySelection","buttons","modifiers","ctrlKey","metaKey","altKey","shiftKey","dist","visibleLines","lineIndex","findCursorLineIndex","newIndex","min","max","applyScroll","findCursorLine","updateDisplaySymbols","searchPrompt","searchNext","promptGoto","editBreakpoint","selectionTop","selectionBottom","updateSelection","y","pageY","pageYOffset","index","addr","i","addressSize","forEach","selectedLines","bind","values","linesChanged","selectionChanged","offsetsUpdate","calcOffsets","selectedUpdate","getSelectedLineParams","DisasmSearch","updateSearchString","handleNext","handleCancel","handleKeyDown","searchString","inProgress","hidden","placeholder","role","StatusBar","renderLeftStatus","function","dataAccess","renderDataAccess","renderBranch","stringValue","renderString","renderDataSymbol","dataSymbol","status","valueSymbol","toString04X","targetAddress","JSON","stringify","changeCallbacks_","ppsspp_","connected_","connected","callback","remove","splice","onConnectionChange","handlers","hasOwnProperty","onConnection","listen","MIN_BUFFER","Disasm","wantDisplaySymbols","searchInProgress","editingBreakpoint","creatingBreakpoint","jumpStack","needsOffsetFix","updatesCancel","updatesSequence","Promise","resolve","lastSearch","minBuffer","maxBuffer","updateDisasmNow","branchAddresses","unlabeledBranches","b","firstLine","flag","gotoAddress","pop","pc","startCode","code","writeInstruction","nextAddress","updateDisasm","assignment","keep","breakpointAddress","bp","breakpoints","closeEditBreakpoint","snap","searchDisasm","cont","continueLast","searchCancel","last","cancelState","finally","listRef","ensureCursorInView","searchRef","scrollTop","onScroll","onDragStart","started","renderContextMenu","renderNotStarted","centerAddress","listeners_","hasRange","category","register","forget","snapshot","disasmChange","updateDisasmRange","setInitialPC","foundLine","clientHeight","jumpMarker","list","newRange","updateRange","defaultBuffer","count","cleanupBranchGuides","unique","Map","set","bufferRange","bufferTop","bufferBottom","scrollHeight","visibleEachDirection","DisasmButtons","breakpointModalOpen","lastThread","threads","handleGoBreak","updateCurrentThread","handleStepInto","handleStepOver","handleStepOut","threadID","handleNextHLE","handleThreadSelect","th","Number","handleBreakpointOpen","handleBreakpointClose","showNavTray","paused","renderThreadList","renderThread","isCurrent","updateThreadList","resetCurrentThread","GotoBox","handleSubmit","gotoDisasm","handlePC","jumpToReg","handleRA","autoComplete","promptGotoMarker","select","FuncList","loading","rowHeight","functions","filteredFunctions","renderSizedList","rowRenderer","renderFunc","rowCount","handleFilter","applyFilter","handleClick","renderList","updateList","measureHeight","sort","a","localeCompare","RegList","registerNames","reg","renderReg","cat","format","ddClasses","changed","uintValues","floatValues","uintValuesLast","RegPanel","categories","handleViewMemory","handleViewDisassembly","handleCopyReg","regNode","handleChangeReg","prevValue","registerName","newValue","packet","renderTabs","c","updateRegs","updateReg","keepLast","hasPrev","prevCat","floatValuesLast","error","replaceCopy","arr","item","slice","concat","floatValue","VisualizeVFPU","handleFormat","matrices","m","renderMatrix","renderColumn","renderValue","r","LeftPanel","vfpuModalOpen","everShownFuncs","handleSelect","handleVFPUOpen","handleVFPUClose","onSelect","forceRender","CPU","lastTicks","ticks","navTray","hideNavTray","updateInitialPC","commonProps","disasmProps","onStepping","GPU","recording","beginRecord","setAttribute","href","uri","click","removeChild","LogItem","formatLogEvent","renderInternal","makeClassName","timestamp","header","channel","level","Log","items","divRef","renderItem","newItem","itemWithId","onError","addLogItem","onLogEvent","NotConnected","connecting","elements","connect","NoResponseEvents","ErrorLevels","PPSSPP","socket_","pendingTickets_","reject","fetch","response","json","listing","tryNextEndpoint_","setupSocket_","specificError","originalError","possibleSocket","WebSocket","onopen","onclose","failAllPending_","close","eventName","ticket","makeTicket_","originalMessage","onmessage","parse","handleError_","handled","handleTicket_","handleMessage_","endpoint","ip","p","executeHandlers_","random","versionInfo","process","version","App","handleAutoConnect","autoConnect","handleDisconnect","disconnect","logRef","updateTitle","game","originalTitle","init","to","src","logo","alt","renderContent","testing","isLocalhost","Boolean","location","hostname","registerValidSW","swUrl","serviceWorker","registration","onupdatefound","installingWorker","installing","onstatechange","controller","ReactDOM","render","Modal","setAppElement","URL","origin","headers","get","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.e5939e72.chunk.js","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport Modal from 'react-modal';\nimport '../ext/react-modal.css';\n\nclass FitModal extends PureComponent {\n\trender() {\n\t\treturn (\n\t\t\t<Modal\n\t\t\t\tclassName=\"ReactModal__FitContent\" overlayClassName=\"ReactModal__FitOverlay\"\n\t\t\t\tonRequestClose={this.handleRequestClose}\n\t\t\t\tcloseTimeoutMS={150}\n\t\t\t\t{...this.props}\n\t\t\t/>\n\t\t);\n\t}\n\n\thandleRequestClose = () => {\n\t\tif (this.props.confirmClose) {\n\t\t\tif (!window.confirm(this.props.confirmClose)) {\n\t\t\t\t// Don't close.\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.props.onClose();\n\t}\n}\n\nFitModal.propTypes = {\n\tisOpen: PropTypes.bool.isRequired,\n\tonClose: PropTypes.func.isRequired,\n\tconfirmClose: PropTypes.string,\n\tchildren: PropTypes.node,\n};\n\nexport default FitModal;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nclass Field extends Component {\n\trender() {\n\t\tconst { label, children } = this.props;\n\t\treturn (\n\t\t\t<div className=\"Field\">\n\t\t\t\t<label className=\"Field__label\" htmlFor={this.fieldID()}>{label}</label>\n\t\t\t\t{this.renderInput()}\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderInput() {\n\t\tif (this.props.type === 'text') {\n\t\t\treturn this.renderText();\n\t\t} else if (this.props.type === 'hex') {\n\t\t\treturn this.renderHex();\n\t\t} else if (this.props.type === 'radio') {\n\t\t\treturn this.renderRadio();\n\t\t} else if (this.props.type === 'checkboxes') {\n\t\t\treturn this.renderCheckboxes();\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\trenderText(other = {}) {\n\t\tlet { label, type, children, onChange, component, prop, ...primary } = this.props;\n\t\tprimary.value = this.fieldValue();\n\t\treturn <input type=\"text\" id={this.fieldID()} onChange={this.handleChange} {...primary} {...other} />;\n\t}\n\n\trenderHex() {\n\t\treturn this.renderText({ pattern: '(0x)?[0-9A-Fa-f]+', title: 'Hexadecimal value' });\n\t}\n\n\trenderRadio() {\n\t\tconst value = this.fieldValue();\n\t\treturn this.props.options.map(option => {\n\t\t\tconst props = {\n\t\t\t\tname: this.fieldID(),\n\t\t\t\tvalue: option.value,\n\t\t\t\tchecked: value === option.value,\n\t\t\t\tonChange: this.handleChange,\n\t\t\t\tdisabled: this.props.disabled,\n\t\t\t};\n\t\t\treturn (\n\t\t\t\t<label key={option.value}>\n\t\t\t\t\t<input type=\"radio\" {...props} />\n\t\t\t\t\t{' ' + option.label}\n\t\t\t\t</label>\n\t\t\t);\n\t\t});\n\t}\n\n\trenderCheckboxes() {\n\t\treturn this.props.options.map(option => {\n\t\t\tconst props = {\n\t\t\t\t'data-prop': option.value,\n\t\t\t\tchecked: this.props.component.state[option.value],\n\t\t\t\tonChange: this.handleChange,\n\t\t\t\tdisabled: this.props.disabled,\n\t\t\t};\n\t\t\treturn (\n\t\t\t\t<label key={option.value}>\n\t\t\t\t\t<input type=\"checkbox\" {...props} />\n\t\t\t\t\t{' ' + option.label}\n\t\t\t\t</label>\n\t\t\t);\n\t\t});\n\t}\n\n\tfieldID() {\n\t\tconst { id, component, prop } = this.props;\n\t\tif (!id && component && prop) {\n\t\t\treturn (component.displayName || component.constructor.name) + '__' + prop;\n\t\t}\n\t\treturn id;\n\t}\n\n\tfieldValue() {\n\t\tconst { value, component, prop } = this.props;\n\t\tif (value === undefined && component && prop) {\n\t\t\treturn component.state[prop];\n\t\t}\n\t\treturn value;\n\t}\n\n\thandleChange = (ev) => {\n\t\tif (this.props.onChange) {\n\t\t\tthis.props.onChange(ev);\n\t\t} else if (this.props.component) {\n\t\t\tconst { target } = ev;\n\t\t\tconst prop = target.dataset.prop || this.props.prop;\n\t\t\tconst value = target.type === 'checkbox' ? target.checked : target.value;\n\t\t\tthis.props.component.setState({ [prop]: value });\n\t\t}\n\t}\n}\n\nField.propTypes = {\n\tid: PropTypes.string,\n\tlabel: PropTypes.node.isRequired,\n\ttype: PropTypes.oneOf(['text', 'hex', 'radio', 'checkboxes']),\n\tcomponent: PropTypes.object,\n\tvalue: PropTypes.string,\n\tprop: PropTypes.string,\n\toptions: PropTypes.arrayOf(PropTypes.shape({\n\t\tlabel: PropTypes.string.isRequired,\n\t\tvalue: PropTypes.string.isRequired,\n\t})),\n\tdisabled: PropTypes.bool,\n\tonChange: PropTypes.func,\n\tchildren: PropTypes.node,\n};\n\nexport default Field;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'clsx';\nimport './Form.css';\n\nfunction Form(props) {\n\t/* eslint no-script-url: \"off\" */\n\treturn (\n\t\t<form action=\"#\" className={classNames(props.className, 'Form')} onSubmit={props.onSubmit}>\n\t\t\t{props.heading ? <h2 className=\"Form__heading\">{props.heading}</h2> : null}\n\t\t\t{props.children}\n\t\t</form>\n\t);\n}\n\nForm.propTypes = {\n\tonSubmit: PropTypes.func.isRequired,\n\tclassName: PropTypes.string,\n\tchildren: PropTypes.node.isRequired,\n};\n\nForm.Buttons = function (props) {\n\tconst saveHandler = props.onSave !== true ? props.onSave : undefined;\n\tconst saveButton = props.onSave ? <button onClick={saveHandler}>Save</button> : null;\n\tconst cancelButton = props.onCancel ? <button type=\"button\" onClick={props.onCancel}>Cancel</button> : null;\n\n\treturn (\n\t\t<div className=\"Form__buttons\">\n\t\t\t{props.children}\n\t\t\t{saveButton}\n\t\t\t{cancelButton}\n\t\t</div>\n\t);\n};\n\nForm.Buttons.propTypes = {\n\tonSave: PropTypes.oneOfType([PropTypes.func, PropTypes.bool]),\n\tonCancel: PropTypes.func,\n\tchildren: PropTypes.node,\n};\n\nexport default Form;\n","export class Timeout {\n\thandle;\n\tfunc;\n\tms;\n\n\tconstructor(func, ms) {\n\t\tthis.func = func;\n\t\tthis.ms = ms;\n\t}\n\n\tstart() {\n\t\tthis.cancel();\n\t\tthis.handle = setTimeout(() => {\n\t\t\tthis.handle = null;\n\t\t\tthis.func();\n\t\t}, this.ms);\n\t}\n\n\treset(func) {\n\t\tthis.func = func;\n\t}\n\n\trunEarly() {\n\t\tif (this.handle) {\n\t\t\tthis.cancel();\n\t\t\tthis.func();\n\t\t}\n\t}\n\n\tcancel() {\n\t\tif (this.handle !== null) {\n\t\t\tclearTimeout(this.handle);\n\t\t\tthis.handle = null;\n\t\t}\n\t}\n}\n","export function toString08X(val) {\n\tconst hex = val.toString(16).toUpperCase();\n\treturn ('00000000' + hex).substr(-8);\n}\n\nexport function toString04X(val) {\n\tconst hex = val.toString(16).toUpperCase();\n\treturn ('0000' + hex).substr(-4);\n}\n\nexport function toString02X(val) {\n\tconst hex = val.toString(16).toUpperCase();\n\treturn ('00' + hex).substr(-2);\n}\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport FitModal from '../common/FitModal';\nimport Field from '../common/Field';\nimport Form from '../common/Form';\nimport { Timeout } from '../../utils/timeouts';\nimport { toString08X } from '../../utils/format';\nimport '../ext/react-modal.css';\nimport './BreakpointModal.css';\n\nconst typeOptions = [\n\t{ label: 'Memory', value: 'memory' },\n\t{ label: 'Execute', value: 'execute' },\n];\n\nconst operationOptions = [\n\t{ label: 'Read', value: 'read' },\n\t{ label: 'Write', value: 'write' },\n\t{ label: 'On change', value: 'change' },\n];\n\nconst actionOptions = [\n\t{ label: 'Break', value: 'enabled' },\n\t{ label: 'Log', value: 'log' },\n];\n\nclass BreakpointModal extends PureComponent {\n\tstate = {};\n\tcleanState = {\n\t\tisOpen: false,\n\t\tderivedBreakpoint: null,\n\t};\n\tcleanBreakpoint = {\n\t\ttype: 'memory',\n\t\taddress: '',\n\t\tsize: '0x00000001',\n\t\tcondition: '',\n\t\tlogFormat: '',\n\t\tread: true,\n\t\twrite: true,\n\t\tchange: false,\n\t\tenabled: true,\n\t\tlog: true,\n\t};\n\tcleanTimeout;\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tObject.assign(this.state, { ...this.cleanState, ...this.cleanBreakpoint, ...props.breakpoint, ...props.initialOverrides });\n\n\t\tthis.cleanTimeout = new Timeout(() => {\n\t\t\tthis.setState({ ...this.cleanState, ...this.cleanBreakpoint, ...this.props.breakpoint, ...this.props.initialOverrides });\n\t\t}, 200);\n\t}\n\n\trender() {\n\t\tconst editing = !!this.props.breakpoint;\n\n\t\treturn (\n\t\t\t<FitModal\n\t\t\t\tcontentLabel=\"Breakpoint settings\"\n\t\t\t\tisOpen={this.props.isOpen}\n\t\t\t\tonClose={this.onClose}\n\t\t\t\tconfirmClose={this.hasChanges() ? 'Discard changes?' : null}\n\t\t\t>\n\t\t\t\t<Form heading={editing ? 'Edit Breakpoint' : 'Create Breakpoint'} onSubmit={this.onSave} className=\"BreakpointModal\">\n\t\t\t\t\t<Field type=\"radio\" label=\"Type\" options={typeOptions} prop=\"type\" component={this} />\n\t\t\t\t\t<Field type=\"text\" label=\"Address\" prop=\"address\" component={this} />\n\t\t\t\t\t{this.renderMemory()}\n\t\t\t\t\t{this.renderExecute()}\n\t\t\t\t\t<Field type=\"text\" label=\"Log format\" prop=\"logFormat\" component={this} disabled={!this.state.log} />\n\t\t\t\t\t<Field type=\"checkboxes\" label=\"Actions\" options={actionOptions} component={this} />\n\n\t\t\t\t\t<Form.Buttons onSave={true} onCancel={this.onClose} />\n\t\t\t\t</Form>\n\t\t\t</FitModal>\n\t\t);\n\t}\n\n\trenderMemory() {\n\t\tif (this.state.type !== 'memory') {\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t<Field type=\"hex\" label=\"Size\" prop=\"size\" component={this} />\n\t\t\t\t<Field type=\"checkboxes\" label=\"Operations\" options={operationOptions} component={this} />\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n\n\trenderExecute() {\n\t\tif (this.state.type !== 'execute') {\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t<Field type=\"text\" label=\"Condition\" prop=\"condition\" component={this} />\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n\n\thasChanges() {\n\t\tconst compareTo = this.state.derivedBreakpoint || this.cleanBreakpoint;\n\t\treturn Object.keys(compareTo).find(key => this.state[key] !== compareTo[key]) !== undefined;\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (this.props.isOpen && this.cleanTimeout != null) {\n\t\t\tthis.cleanTimeout.runEarly();\n\t\t}\n\t}\n\n\tonSave = (e) => {\n\t\tlet operation = this.props.ppsspp.send({\n\t\t\tevent: 'cpu.evaluate',\n\t\t\tthread: this.props.currentThread,\n\t\t\texpression: this.state.address,\n\t\t});\n\n\t\tif (this.props.breakpoint) {\n\t\t\tconst { derivedBreakpoint, address, size, type } = this.state;\n\t\t\tif (type !== derivedBreakpoint.type || derivedBreakpoint.address !== address) {\n\t\t\t\toperation = operation.then(this.deleteOld).then(this.saveNew);\n\t\t\t} else if (type === 'memory' && derivedBreakpoint.size !== size) {\n\t\t\t\toperation = operation.then(this.deleteOld).then(this.saveNew);\n\t\t\t} else {\n\t\t\t\toperation = operation.then(this.updateExisting);\n\t\t\t}\n\t\t} else {\n\t\t\toperation = operation.then(this.saveNew);\n\t\t}\n\n\t\toperation.then(this.onClose, err => {\n\t\t\twindow.alert(err.message);\n\t\t});\n\n\t\te.preventDefault();\n\t}\n\n\tsaveNew = ({ uintValue }) => {\n\t\treturn this.props.ppsspp.send({\n\t\t\tevent: this.getEvent(this.state.type, 'add'),\n\t\t\t...this.state,\n\t\t\taddress: uintValue,\n\t\t});\n\t}\n\n\tdeleteOld = ({ uintValue }) => {\n\t\t// This is used when changing the breakpoint type.\n\t\treturn this.props.ppsspp.send({\n\t\t\tevent: this.getEvent(this.props.breakpoint.type, 'remove'),\n\t\t\taddress: this.props.breakpoint.address,\n\t\t}).then(() => {\n\t\t\t// Return the original new address for easy sequencing.\n\t\t\treturn { uintValue };\n\t\t});\n\t}\n\n\tupdateExisting = ({ uintValue }) => {\n\t\treturn this.props.ppsspp.send({\n\t\t\tevent: this.getEvent(this.state.type, 'update'),\n\t\t\t...this.state,\n\t\t\taddress: uintValue,\n\t\t});\n\t}\n\n\tgetEvent(type, event) {\n\t\tif (type === 'execute') {\n\t\t\treturn 'cpu.breakpoint.' + event;\n\t\t} else if (type === 'memory') {\n\t\t\treturn 'memory.breakpoint.' + event;\n\t\t} else {\n\t\t\tthrow new Error('Unexpected type: ' + type);\n\t\t}\n\t}\n\n\tonClose = () => {\n\t\tthis.cleanTimeout.start();\n\t\tthis.props.onClose();\n\t}\n\n\tstatic getDerivedStateFromProps(nextProps, prevState) {\n\t\tif (nextProps.isOpen && !prevState.isOpen) {\n\t\t\tconst derivedBreakpoint = nextProps.breakpoint;\n\t\t\tif (derivedBreakpoint) {\n\t\t\t\t// This is the \"derived\" unchanged state for the \"Discard changes?\" prompt, and initial state.\n\t\t\t\tderivedBreakpoint.address = '0x' + toString08X(derivedBreakpoint.address);\n\t\t\t\tderivedBreakpoint.condition = derivedBreakpoint.condition || '';\n\t\t\t\tderivedBreakpoint.logFormat = derivedBreakpoint.logFormat || '';\n\t\t\t}\n\t\t\tconst initialOverrides = nextProps.initialOverrides;\n\t\t\tif (initialOverrides) {\n\t\t\t\tinitialOverrides.address = '0x' + toString08X(initialOverrides.address);\n\t\t\t}\n\t\t\treturn { isOpen: true, ...derivedBreakpoint, derivedBreakpoint, ...initialOverrides };\n\t\t}\n\t\tif (!nextProps.isOpen && prevState.derivedBreakpoint) {\n\t\t\treturn { derivedBreakpoint: null };\n\t\t}\n\t\treturn null;\n\t}\n}\n\nBreakpointModal.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n\tisOpen: PropTypes.bool.isRequired,\n\tcurrentThread: PropTypes.number,\n\tbreakpoint: PropTypes.shape({\n\t\ttype: PropTypes.oneOf(['execute', 'memory']),\n\t\taddress: PropTypes.number.isRequired,\n\t}),\n\tinitialOverrides: PropTypes.shape({\n\t\ttype: PropTypes.oneOf(['execute', 'memory']),\n\t\taddress: PropTypes.number.isRequired,\n\t}),\n\n\tonClose: PropTypes.func.isRequired,\n};\n\nexport default BreakpointModal;\n","// We set this to false when we trigger one.\nlet userInitiated = true;\n\nlet listeners = [];\n\nfunction createScratchpad() {\n\tconst div = document.createElement('div');\n\tdiv.id = 'clipboard-scratchpad';\n\tdiv.style.width = 1;\n\tdiv.style.height = 1;\n\tdiv.style.opacity = 0;\n\tdiv.style.position = 'absolute';\n\tdiv.style.top = 0;\n\tdiv.style.left = 0;\n\tdiv.style.pointerEvents = 'none';\n\tdiv.style.whiteSpace = 'pre';\n\tdocument.body.appendChild(div);\n\n\treturn div;\n}\n\nfunction getScratchpad() {\n\tconst div = document.getElementById('clipboard-scratchpad');\n\tif (!div) {\n\t\treturn createScratchpad();\n\t}\n\treturn div;\n}\n\nexport function copyText(text) {\n\tuserInitiated = false;\n\n\ttry {\n\t\tconst scratchpad = getScratchpad();\n\t\tscratchpad.textContent = text;\n\n\t\tconst textNode = scratchpad.firstChild;\n\t\tconst range = document.createRange();\n\t\trange.setStart(textNode, 0);\n\t\trange.setEnd(textNode, text.length);\n\n\t\tconst selection = window.getSelection();\n\t\tconst oldRange = selection.rangeCount !== 0 ? selection.getRangeAt(0) : null;\n\n\t\tselection.removeAllRanges();\n\t\tselection.addRange(range);\n\n\t\ttry {\n\t\t\tdocument.execCommand('copy');\n\t\t} catch (e) {\n\t\t\twindow.prompt('Use Ctrl-C or Command-C to copy', text);\n\t\t}\n\n\t\tselection.removeAllRanges();\n\t\tif (oldRange) {\n\t\t\tselection.addRange(oldRange);\n\t\t}\n\t} finally {\n\t\tuserInitiated = true;\n\t}\n}\n\nexport function listenCopy(selector, handler) {\n\tlisteners.push({ selector, handler });\n}\n\nexport function forgetCopy(selector, handler) {\n\tlisteners = listeners.filter(l => l.selector !== selector && l.handler !== handler);\n}\n\nif (!Element.prototype.matches) {\n\tElement.prototype.matches = Element.prototype.msMatchesSelector;\n}\n\nfunction hasClosestMatch(node, selector) {\n\twhile (node && node !== document) {\n\t\tif (node.matches(selector)) {\n\t\t\treturn true;\n\t\t}\n\t\tnode = node.parentNode;\n\t}\n\n\treturn false;\n}\n\ndocument.addEventListener('copy', (ev) => {\n\tconst range = document.getSelection().rangeCount !== 0 ? document.getSelection().getRangeAt(0) : null;\n\tif ((range && !range.collapsed) || !userInitiated) {\n\t\t// Skip if the user has anything actually selected, or if we triggered this 'copy' command.\n\t\treturn;\n\t}\n\n\tfor (let listener of listeners) {\n\t\tif (!hasClosestMatch(document.activeElement, listener.selector)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst result = listener.handler(ev);\n\t\tif (result) {\n\t\t\t// Unfortunate, but newline conversion isn't automatic...\n\t\t\tif (/win/i.test(window.navigator.platform)) {\n\t\t\t\tev.clipboardData.setData('text/plain', result.replace(/\\n/g, '\\r\\n'));\n\t\t\t} else {\n\t\t\t\tev.clipboardData.setData('text/plain', result);\n\t\t\t}\n\t\t\tev.preventDefault();\n\t\t}\n\t}\n});\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { ContextMenu, MenuItem, connectMenu } from 'react-contextmenu';\nimport { copyText } from '../../utils/clipboard';\nimport { toString08X } from '../../utils/format';\n\nclass DisasmContextMenu extends PureComponent {\n\trender() {\n\t\tconst { id, trigger } = this.props;\n\t\tconst disabled = !this.props.stepping;\n\t\tconst line = trigger && trigger.line;\n\n\t\tconst followBranch = line && (line.branch !== null || line.relevantData !== null || line.type === 'data');\n\n\t\treturn (\n\t\t\t<ContextMenu id={id}>\n\t\t\t\t<MenuItem onClick={this.handleCopyAddress}>\n\t\t\t\t\tCopy Address\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem onClick={this.handleCopyHex}>\n\t\t\t\t\tCopy Instruction (Hex)\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem onClick={this.handleCopyDisasm}>\n\t\t\t\t\tCopy Instruction (Disasm)\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem divider />\n\t\t\t\t<MenuItem disabled={disabled} onClick={this.handleAssemble}>\n\t\t\t\t\tAssemble Opcode...\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem divider />\n\t\t\t\t<MenuItem disabled={disabled} onClick={this.handleRunUntil}>\n\t\t\t\t\tRun to Cursor\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem disabled={disabled} onClick={this.handleJumpPC}>\n\t\t\t\t\tJump to Cursor\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem onClick={this.handleToggleBreakpoint}>\n\t\t\t\t\tToggle Breakpoint\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem divider />\n\t\t\t\t<MenuItem disabled={!followBranch} onClick={this.handleFollowBranch}>\n\t\t\t\t\tFollow Branch\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem data={{ action: 'goto_memory' }} onClick={this.handleTodo}>\n\t\t\t\t\tGo to in Memory View\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem data={{ action: 'goto_jit' }} onClick={this.handleTodo}>\n\t\t\t\t\tGo to in Jit Compare\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem divider />\n\t\t\t\t<MenuItem data={{ action: 'func_rename' }} onClick={this.handleTodo}>\n\t\t\t\t\tRename Function...\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem data={{ action: 'func_remove' }} onClick={this.handleTodo}>\n\t\t\t\t\tRemove Function\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem data={{ action: 'func_add' }} onClick={this.handleTodo}>\n\t\t\t\t\tAdd Function Here\n\t\t\t\t</MenuItem>\n\t\t\t</ContextMenu>\n\t\t);\n\t}\n\n\thandleCopyAddress = (ev, data) => {\n\t\tcopyText(toString08X(data.line.address));\n\t\tdata.node.focus();\n\t}\n\n\thandleCopyHex = (ev, data) => {\n\t\tconst hexLines = this.props.getSelectedLines().map(line => {\n\t\t\t// Include each opcode of a macro if it's a macro.\n\t\t\treturn line.macroEncoding ? line.macroEncoding.map(toString08X).join(\"\\n\") : toString08X(line.encoding);\n\t\t});\n\t\tcopyText(hexLines.join(\"\\n\"));\n\t\tdata.node.focus();\n\t}\n\n\thandleCopyDisasm = (ev, data) => {\n\t\tconst lines = this.props.getSelectedDisasm();\n\t\tcopyText(lines);\n\t\tdata.node.focus();\n\t}\n\n\thandleAssemble = (ev, data) => {\n\t\t// Delay so the context menu can close before the prompt.\n\t\tsetTimeout(() => {\n\t\t\tthis.props.assembleInstruction(data.line, '').catch(() => {\n\t\t\t\t// Exception logged.\n\t\t\t});\n\t\t}, 0);\n\t}\n\n\thandleRunUntil = (ev, data) => {\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'cpu.runUntil',\n\t\t\taddress: data.line.address,\n\t\t}).catch(() => {\n\t\t\t// Already logged, let's assume the parent will have marked it disconnected/not started by now.\n\t\t});\n\t\tdata.node.focus();\n\t}\n\n\thandleJumpPC = (ev, data) => {\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'cpu.setReg',\n\t\t\tthread: this.props.currentThread,\n\t\t\tname: 'pc',\n\t\t\tvalue: data.line.address,\n\t\t}).catch((err) => {\n\t\t\tthis.props.log('Failed to update PC: ' + err);\n\t\t});\n\t}\n\n\thandleToggleBreakpoint = (ev, data) => {\n\t\tthis.props.toggleBreakpoint(data.line);\n\t}\n\n\thandleFollowBranch = (ev, data) => {\n\t\tthis.props.followBranch(true, data.line);\n\t}\n\n\thandleTodo = (ev, data) => {\n\t\t// TODO\n\t\tconsole.log(data);\n\t\tdata.node.focus();\n\t}\n}\n\nDisasmContextMenu.propTypes = {\n\tid: PropTypes.string.isRequired,\n\ttrigger: PropTypes.shape({\n\t\tline: PropTypes.shape({\n\t\t\ttype: PropTypes.string,\n\t\t\tbranch: PropTypes.object,\n\t\t\trelevantData: PropTypes.object,\n\t\t}),\n\t}),\n\tppsspp: PropTypes.object.isRequired,\n\tlog: PropTypes.func.isRequired,\n\tstepping: PropTypes.bool.isRequired,\n\tcurrentThread: PropTypes.number,\n\n\tgetSelectedLines: PropTypes.func.isRequired,\n\tgetSelectedDisasm: PropTypes.func.isRequired,\n\tfollowBranch: PropTypes.func.isRequired,\n\tassembleInstruction: PropTypes.func.isRequired,\n\ttoggleBreakpoint: PropTypes.func.isRequired,\n};\n\nexport default connectMenu('disasm')(DisasmContextMenu);\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'clsx';\n\nclass DisasmBranchGuide extends PureComponent {\n\trender() {\n\t\tconst pos = this.calcPos();\n\t\tif (pos === null || this.props.lineHeight === 0) {\n\t\t\treturn null;\n\t\t}\n\t\tconst classes = classNames({\n\t\t\t'DisasmBranchGuide': true,\n\t\t\t'DisasmBranchGuide--selected': this.props.selected,\n\t\t});\n\n\t\treturn (\n\t\t\t<div className={classes} style={pos}>\n\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"8\" height={pos.height}>\n\t\t\t\t\t<path d={this.buildPath(pos.height)} />\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tbuildPath(height) {\n\t\tconst { guide, range, lineHeight } = this.props;\n\t\tconst yCenter = Math.floor(lineHeight / 2) + 0.5;\n\n\t\t// Parts: trailing connects to outside view.\n\t\tconst trailingEdge = `m7.5,-${yCenter} l0,${lineHeight} m-7.5,-${lineHeight - yCenter}`;\n\t\tconst sourceEdge = 'm3,0 l5,0 m-8,0';\n\t\tconst arrowEdge = 'm5.5,-4 l-4,4 l4,4 m-3.5,-4 l6,0 m-8,0';\n\n\t\t// Start at the y center so our parts are reusable for top and bottom.\n\t\tlet path = ['M0,' + yCenter];\n\n\t\tif (guide.top < range.start) {\n\t\t\tpath.push(trailingEdge);\n\t\t} else if (guide.direction === 'up') {\n\t\t\tpath.push(arrowEdge);\n\t\t} else {\n\t\t\tpath.push(sourceEdge);\n\t\t}\n\n\t\tpath.push('m7.5,0 l0,' + (height - lineHeight) + ' m-7.5,0');\n\n\t\tif (guide.bottom >= range.end) {\n\t\t\tpath.push(trailingEdge);\n\t\t} else if (guide.direction === 'down') {\n\t\t\tpath.push(arrowEdge);\n\t\t} else {\n\t\t\tpath.push(sourceEdge);\n\t\t}\n\n\t\treturn path.join(' ');\n\t}\n\n\tcalcPos() {\n\t\tconst { guide } = this.props;\n\t\tconst top = this.findAddressOffset(guide.top, false);\n\t\tconst bottom = this.findAddressOffset(guide.bottom, true);\n\t\tif (top === null || bottom === null) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst right = (16 - guide.lane) * 8;\n\t\tconst height = bottom - top;\n\t\treturn { top, right, height };\n\t}\n\n\tfindAddressOffset(address, down) {\n\t\tconst { offsets, range } = this.props;\n\t\tif (address >= range.end) {\n\t\t\tif ((range.end - 4) in offsets && down) {\n\t\t\t\treturn offsets[range.end - 4] + this.props.lineHeight;\n\t\t\t}\n\t\t\tif ((range.end - 8) in offsets && down) {\n\t\t\t\treturn offsets[range.end - 8] + this.props.lineHeight;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tlet off;\n\t\tif (address < range.start && !down) {\n\t\t\toff = 0;\n\t\t} else if (address in offsets) {\n\t\t\toff = offsets[address];\n\t\t} else if (address - 4 in offsets) {\n\t\t\t// Inside a macro?\n\t\t\toff = offsets[address - 4];\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn down ? off + this.props.lineHeight : off;\n\t}\n}\n\nDisasmBranchGuide.propTypes = {\n\tguide: PropTypes.shape({\n\t\tdirection: PropTypes.oneOf(['up', 'down']).isRequired,\n\t\ttop: PropTypes.number.isRequired,\n\t\tbottom: PropTypes.number.isRequired,\n\t\tlane: PropTypes.number.isRequired,\n\t}).isRequired,\n\toffsets: PropTypes.object.isRequired,\n\trange: PropTypes.shape({\n\t\tstart: PropTypes.number.isRequired,\n\t\tend: PropTypes.number.isRequired,\n\t}).isRequired,\n\tlineHeight: PropTypes.number.isRequired,\n\tselected: PropTypes.bool,\n};\n\nexport default DisasmBranchGuide;\n","function isSubsetBounds(bounds, parentBounds) {\n\tif (bounds.top < parentBounds.top || bounds.left < parentBounds.left) {\n\t\treturn false;\n\t}\n\tif (bounds.bottom > parentBounds.bottom || bounds.right > parentBounds.right) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nexport function isInView(node) {\n\tconst windowBounds = { top: 0, left: 0, bottom: window.innerHeight, right: window.innerWidth };\n\tconst rect = node.getBoundingClientRect();\n\tif (!isSubsetBounds(rect, windowBounds)) {\n\t\treturn false;\n\t}\n\n\tlet parentNode = node;\n\twhile ((parentNode = parentNode.parentNode) !== null) {\n\t\tif (parentNode instanceof HTMLElement) {\n\t\t\tconst style = window.getComputedStyle(parentNode);\n\t\t\tconst overflows = style.overflow + style.overflowX + style.overflowY;\n\t\t\tif (style.position === 'static' && overflows.indexOf('auto') === -1 && overflows.indexOf('scroll') === -1) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!isSubsetBounds(rect, parentNode.getBoundingClientRect())) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport function ensureInView(node, options) {\n\tif (!isInView(node)) {\n\t\tnode.scrollIntoView(options);\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nlet contextMenuStatus = false;\n\nwindow.addEventListener('REACT_CONTEXTMENU_SHOW', (ev) => {\n\tcontextMenuStatus = true;\n});\nwindow.addEventListener('REACT_CONTEXTMENU_HIDE', (ev) => {\n\tcontextMenuStatus = false;\n});\n\nexport function hasContextMenu() {\n\treturn contextMenuStatus;\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nexport default function BreakpointIcon(props) {\n\treturn (\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" className={props.className} viewBox=\"0 0 1536 1536\" width=\"12\" height=\"12\">\n\t\t\t<path d=\"M768,0 q209,0 385.5,103 t279.5,279.5 t103,385.5 t-103,385.5 t-279.5,279.5 t-385.5,103 t-385.5,-103 t-279.5,-279.5 t-103,-385.5 t103,-385.5 t279.5,-279.5 t385.5,-103 zm128,1247 v-190 q0,-14 -9,-23.5 t-22,-9.5 h-192 q-13,0 -23,10 t-10,23 v190 q0,13 10,23 t23,10 h192 q13,0 22,-9.5 t9,-23.5 zm-2,-344 l18,-621 q0,-12 -10,-18 q-10,-8 -24,-8 h-220 q-14,0 -24,8 q-10,6 -10,18 l17,621 q0,10 10,17.5 t24,7.5 h185 q14,0 23.5,-7.5 t10.5,-17.5 z\" />\n\t\t</svg>\n\t);\n}\n\nBreakpointIcon.propTypes = {\n\tclassName: PropTypes.string.isRequired,\n};\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { ContextMenuTrigger } from 'react-contextmenu';\nimport { toString08X } from '../../utils/format';\nimport { ensureInView } from '../../utils/dom';\nimport classNames from 'clsx';\nimport BreakpointIcon from './BreakpointIcon';\n\nclass DisasmLine extends PureComponent {\n\tref;\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.ref = React.createRef();\n\t}\n\n\trender() {\n\t\tconst { line, selected, focused, cursor } = this.props;\n\n\t\tconst className = classNames({\n\t\t\t'DisasmLine': true,\n\t\t\t'DisasmLine--selected': selected && !focused,\n\t\t\t'DisasmLine--focused': focused,\n\t\t\t'DisasmLine--cursor': cursor,\n\t\t\t'DisasmLine--breakpoint': line.breakpoint && line.breakpoint.enabled,\n\t\t\t'DisasmLine--disabled-breakpoint': line.breakpoint && !line.breakpoint.enabled,\n\t\t\t'DisasmLine--current': line.isCurrentPC,\n\t\t});\n\n\t\tconst mapData = (props) => {\n\t\t\treturn { line, node: this.ref.current.parentNode };\n\t\t};\n\t\tconst attributes = {\n\t\t\tonDoubleClick: (ev) => this.onDoubleClick(ev, mapData()),\n\t\t\ttabIndex: 0,\n\t\t};\n\n\t\treturn (\n\t\t\t<ContextMenuTrigger id={this.props.contextmenu} renderTag=\"a\" collect={mapData} attributes={attributes} holdToDisplay={-1}>\n\t\t\t\t<div className={className} style={{ backgroundColor: line.backgroundColor }} ref={this.ref} data-address={line.address}>\n\t\t\t\t\t<BreakpointIcon className=\"DisasmLine__breakpoint-icon\" />\n\t\t\t\t\t{this.renderAddress(line)}\n\t\t\t\t\t<code className=\"DisasmLine__opcode\">{this.highlight(line.name, '', line.params)} </code>\n\t\t\t\t\t<code className=\"DisasmLine__params\">{this.highlightParams(line.params, line.name, '')}{this.renderConditional(line)}</code>\n\t\t\t\t</div>\n\t\t\t</ContextMenuTrigger>\n\t\t);\n\t}\n\n\trenderAddress(line) {\n\t\tconst { symbol, address, encoding } = line;\n\t\tconst addressHex = toString08X(address);\n\n\t\tif (this.props.displaySymbols) {\n\t\t\tif (symbol !== null) {\n\t\t\t\treturn <code className=\"DisasmLine__address DisasmLine__address--symbol\">{this.highlight(symbol + ':')}</code>;\n\t\t\t}\n\t\t\treturn <code className=\"DisasmLine__address DisasmLine__address--nosymbol\">{this.highlight(addressHex)}</code>;\n\t\t}\n\t\treturn (\n\t\t\t<code className=\"DisasmLine__address DisasmLine__address--hexonly\">\n\t\t\t\t{this.highlight(addressHex)} {toString08X(encoding)}\n\t\t\t</code>\n\t\t);\n\t}\n\n\trenderConditional(line) {\n\t\tif (line.isCurrentPC && line.conditionMet !== null) {\n\t\t\treturn line.conditionMet ? ' ; true' : ' ; false';\n\t\t}\n\t\treturn '';\n\t}\n\n\thighlight(text, before = '', after = '') {\n\t\tconst { highlight } = this.props;\n\t\tif (highlight !== null) {\n\t\t\tconst fullText = (before ? before + ' ' : '') + text + ' ' + after;\n\t\t\tlet pos = fullText.toLowerCase().indexOf(highlight);\n\t\t\tlet matchLength = highlight.length;\n\t\t\tif (pos !== -1) {\n\t\t\t\tconst beforeLength = before ? before.length + 1 : 0;\n\t\t\t\tif (pos < beforeLength) {\n\t\t\t\t\tmatchLength -= beforeLength - pos;\n\t\t\t\t\tpos = matchLength > 0 ? 0 : -1;\n\t\t\t\t} else {\n\t\t\t\t\tpos -= beforeLength;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (pos >= 0 && pos < text.length) {\n\t\t\t\tconst className = classNames({\n\t\t\t\t\t'DisasmLine__highlight': true,\n\t\t\t\t\t'DisasmLine__highlight--end': pos + matchLength > text.length + 1,\n\t\t\t\t});\n\t\t\t\treturn (\n\t\t\t\t\t<React.Fragment>\n\t\t\t\t\t\t{text.substr(0, pos)}\n\t\t\t\t\t\t<span className={className}>{text.substr(pos, matchLength)}</span>\n\t\t\t\t\t\t{text.substr(pos + matchLength)}\n\t\t\t\t\t</React.Fragment>\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn text;\n\t}\n\n\thighlightParams(text, before = '', after = '') {\n\t\tconst { highlight, highlightParams } = this.props;\n\t\tif (highlight === null) {\n\t\t\tconst params = text.split(/([,()])/);\n\t\t\tconst toHighlight = highlightParams || [];\n\t\t\treturn params.map((param, key) => {\n\t\t\t\tlet className = 'DisasmLine__param';\n\t\t\t\tif (toHighlight.includes(param)) {\n\t\t\t\t\tclassName += ' DisasmLine__param--highlighted';\n\t\t\t\t}\n\t\t\t\treturn <span className={className} key={key}>{param}</span>;\n\t\t\t});\n\t\t}\n\t\treturn this.highlight(text, before, after);\n\t}\n\n\tonDoubleClick(ev, data) {\n\t\tif (ev.button === 0) {\n\t\t\tthis.props.onDoubleClick(ev, data);\n\t\t}\n\t}\n\n\tensureInView(needsScroll) {\n\t\tconst triggerNode = this.ref.current.parentNode;\n\t\tif (needsScroll !== false) {\n\t\t\tensureInView(triggerNode, { block: needsScroll });\n\t\t}\n\t\ttriggerNode.focus();\n\t}\n\n\tstatic addressBoundingTop(parentNode, address) {\n\t\tconst lineNode = parentNode.querySelector('.DisasmLine[data-address=\"' + address + '\"]');\n\t\tif (lineNode) {\n\t\t\tconst triggerNode = lineNode.parentNode;\n\t\t\treturn triggerNode.getBoundingClientRect().top;\n\t\t}\n\t\treturn null;\n\t}\n}\n\nDisasmLine.propTypes = {\n\tline: PropTypes.shape({\n\t\taddress: PropTypes.number.isRequired,\n\t}).isRequired,\n\tselected: PropTypes.bool,\n\tfocused: PropTypes.bool,\n\tcursor: PropTypes.bool,\n\tdisplaySymbols: PropTypes.bool,\n\thighlight: PropTypes.string,\n\thighlightParams: PropTypes.arrayOf(PropTypes.string),\n\tcontextmenu: PropTypes.string.isRequired,\n\tonDoubleClick: PropTypes.func.isRequired,\n};\n\nexport default DisasmLine;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport DisasmBranchGuide from './DisasmBranchGuide';\nimport DisasmLine from './DisasmLine';\nimport { hasContextMenu } from '../../utils/dom';\nimport { listenCopy, forgetCopy } from '../../utils/clipboard';\nimport { toString08X } from '../../utils/format';\nimport { Timeout } from '../../utils/timeouts';\n\nclass DisasmList extends PureComponent {\n\tstate = {\n\t\tmouseDown: false,\n\t\tfocused: false,\n\t\tlineOffsets: {},\n\t\tpendingLineParams: [],\n\t\tselectedLineParams: [],\n\t\tprevLines: null,\n\t\tprevSelectionTop: null,\n\t\tprevSelectionBottom: null,\n\t};\n\tfocusTimeout;\n\tparamsTimeout;\n\tref;\n\tcursorRef;\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.ref = React.createRef();\n\t\tthis.cursorRef = React.createRef();\n\t\tthis.focusTimeout = new Timeout(() => null, 20);\n\t\tthis.paramsTimeout = new Timeout(() => {\n\t\t\tthis.setState({ selectedLineParams: this.state.pendingLineParams });\n\t\t}, 20);\n\t}\n\n\trender() {\n\t\tconst events = {\n\t\t\tonMouseDownCapture: ev => this.onMouseDown(ev),\n\t\t\tonMouseUpCapture: this.state.mouseDown ? (ev => this.onMouseUp(ev)) : undefined,\n\t\t\tonMouseMove: this.state.mouseDown ? (ev => this.onMouseMove(ev)) : undefined,\n\t\t\tonKeyDown: ev => this.onKeyDown(ev),\n\t\t\tonBlur: ev => this.onFocusChange(ev, false),\n\t\t\tonFocus: ev => this.onFocusChange(ev, true),\n\t\t};\n\n\t\treturn (\n\t\t\t<div className=\"Disasm__list\" ref={this.ref} {...events}>\n\t\t\t\t{this.props.lines.map((line) => this.renderLine(line))}\n\t\t\t\t{this.props.branchGuides.map((guide) => this.renderBranchGuide(guide))}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderLine(line) {\n\t\tconst { displaySymbols, cursor } = this.props;\n\t\tlet props = {\n\t\t\tdisplaySymbols,\n\t\t\tline,\n\t\t\tselected: this.isLineSelected(line),\n\t\t\tcursor: line.address === cursor,\n\t\t\tonDoubleClick: this.props.onDoubleClick,\n\t\t\tref: line.address === cursor ? this.cursorRef : undefined,\n\t\t\t// Avoid re-rendering lines unnecessarily.\n\t\t\thighlight: this.shouldHighlight(line, this.props.highlightText) ? this.props.highlightText : null,\n\t\t\thighlightParams: this.shouldHighlightParams(line) ? this.state.selectedLineParams : null,\n\t\t};\n\t\tprops.focused = props.selected && this.state.focused;\n\n\t\treturn <DisasmLine key={line.address} contextmenu=\"disasm\" {...props} />;\n\t}\n\n\trenderBranchGuide(guide) {\n\t\tconst key = String(guide.top) + String(guide.bottom) + guide.direction;\n\t\tconst { range, lineHeight, cursor } = this.props;\n\t\tconst props = {\n\t\t\tkey,\n\t\t\tguide,\n\t\t\toffsets: this.state.lineOffsets,\n\t\t\trange,\n\t\t\tlineHeight,\n\t\t\tselected: guide.top === cursor || guide.bottom === cursor,\n\t\t};\n\n\t\treturn <DisasmBranchGuide {...props} />;\n\t}\n\n\tshouldHighlight(line, match) {\n\t\tlet parts = [];\n\t\tparts.push(toString08X(line.address));\n\t\tif (line.symbol !== null) {\n\t\t\tparts.push(line.symbol + ':');\n\t\t}\n\t\tparts.push(line.name + ' ' + line.params);\n\n\t\treturn parts.some(part => part.toLowerCase().indexOf(match) !== -1);\n\t}\n\n\tshouldHighlightParams(line, match) {\n\t\tif (this.isLineSelected(line)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this.state.selectedLineParams.some(param => line.params.indexOf(param) !== -1);\n\t}\n\n\t// Exposed to parent.\n\taddressBoundingTop(address) {\n\t\t// It seems like pointless complexity to use a ref for this.\n\t\treturn DisasmLine.addressBoundingTop(this.ref.current, address);\n\t}\n\n\t// Exposed to parent.\n\tensureCursorInView(options) {\n\t\tif (this.cursorRef.current) {\n\t\t\tthis.cursorRef.current.ensureInView(options);\n\t\t}\n\t}\n\n\tisLineSelected(line) {\n\t\treturn DisasmList.isLineSelected(this.props, line);\n\t}\n\n\tstatic isLineSelected({ selectionTop, selectionBottom }, line) {\n\t\treturn line.address + line.addressSize > selectionTop && line.address <= selectionBottom;\n\t}\n\n\tstatic calcOffsets(lines, lineHeight) {\n\t\tlet pos = 0;\n\t\tlet offsets = {};\n\t\tlines.forEach((line) => {\n\t\t\toffsets[line.address] = pos;\n\t\t\tpos += lineHeight;\n\t\t});\n\t\treturn offsets;\n\t}\n\n\tstatic getSelectedLineParams({ lines, selectionTop, selectionBottom }) {\n\t\tconst selectedLines = lines.filter(DisasmList.isLineSelected.bind(null, { selectionTop, selectionBottom }));\n\n\t\tlet params = {};\n\t\tfor (let line of selectedLines) {\n\t\t\tfor (let param of line.params.split(/[,()]/)) {\n\t\t\t\tparams[param] = param;\n\t\t\t}\n\t\t}\n\t\tdelete params[''];\n\n\t\treturn Object.values(params);\n\t}\n\n\tstatic getDerivedStateFromProps(nextProps, prevState) {\n\t\tconst linesChanged = nextProps.lines !== prevState.prevLines;\n\t\tconst selectionChanged = nextProps.selectionTop !== prevState.prevSelectionTop || nextProps.selectionBottom !== prevState.prevSelectionBottom;\n\n\t\tlet offsetsUpdate = null;\n\t\tif (linesChanged) {\n\t\t\tconst lineOffsets = DisasmList.calcOffsets(nextProps.lines, nextProps.lineHeight);\n\t\t\toffsetsUpdate = { lineOffsets, prevLines: nextProps.lines };\n\t\t}\n\n\t\tlet selectedUpdate = null;\n\t\tif (linesChanged || selectionChanged) {\n\t\t\tselectedUpdate = {\n\t\t\t\tpendingLineParams: DisasmList.getSelectedLineParams(nextProps),\n\t\t\t\tprevSelectionTop: nextProps.selectionTop,\n\t\t\t\tprevSelectionBottom: nextProps.selectionBottom,\n\t\t\t};\n\t\t}\n\n\t\tif (offsetsUpdate !== null || selectedUpdate !== null) {\n\t\t\treturn { ...offsetsUpdate, ...selectedUpdate };\n\t\t}\n\t\treturn null;\n\t}\n\n\tcomponentDidMount() {\n\t\tlistenCopy('.Disasm__list', this.onCopy);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tforgetCopy('.Disasm__list', this.onCopy);\n\t\tthis.paramsTimeout.cancel();\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (this.state.pendingLineParams !== prevState.pendingLineParams) {\n\t\t\t// Apply the line params soon after selection change - not immediately for quicker scrolling.\n\t\t\tthis.paramsTimeout.start();\n\t\t}\n\t}\n\n\tonCopy = (ev) => {\n\t\treturn this.props.getSelectedDisasm();\n\t}\n\n\tonFocusChange(ev, focused) {\n\t\tconst update = () => {\n\t\t\tif (focused !== this.state.focused) {\n\t\t\t\tthis.setState({ focused });\n\t\t\t}\n\t\t};\n\n\t\tthis.focusTimeout.cancel();\n\n\t\tif (!focused) {\n\t\t\t// We use an arbitrary short delay because a click will temporarily blur.\n\t\t\tthis.focusTimeout.reset(update);\n\t\t\tthis.focusTimeout.start();\n\t\t} else {\n\t\t\tupdate();\n\t\t}\n\t}\n\n\tonMouseDown(ev) {\n\t\tconst line = this.mouseEventToLine(ev);\n\t\t// Don't change selection if right clicking within the selection.\n\t\tif (ev.button !== 2 || !this.isLineSelected(line)) {\n\t\t\tthis.applySelection(ev, line);\n\t\t} else {\n\t\t\t// But do change the cursor.\n\t\t\tthis.props.updateCursor(line.address);\n\t\t}\n\t\tif (ev.button === 0) {\n\t\t\tthis.setState({ mouseDown: true });\n\t\t}\n\t}\n\n\tonMouseUp(ev) {\n\t\tconst line = this.mouseEventToLine(ev);\n\t\tif (line) {\n\t\t\tthis.applySelection(ev, line);\n\t\t}\n\t\tthis.setState({ mouseDown: false });\n\t}\n\n\tonMouseMove(ev) {\n\t\tif (ev.buttons === 0) {\n\t\t\tthis.setState({ mouseDown: false });\n\t\t\treturn;\n\t\t}\n\n\t\tconst line = this.mouseEventToLine(ev);\n\t\tif (line) {\n\t\t\tthis.applySelection(ev, line);\n\t\t}\n\t}\n\n\tonKeyDown(ev) {\n\t\tif (hasContextMenu()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst modifiers = (ev.ctrlKey ? 'c' : '') + (ev.metaKey ? 'm' : '') + (ev.altKey ? 'a' : '') + (ev.shiftKey ? 's' : '');\n\n\t\tif (['ArrowUp', 'ArrowDown', 'PageUp', 'PageDown'].includes(ev.key)) {\n\t\t\tlet dist = 1;\n\t\t\tif (ev.key === 'PageUp' || ev.key === 'PageDown') {\n\t\t\t\tdist = this.props.visibleLines;\n\t\t\t}\n\t\t\tif (ev.key === 'ArrowUp' || ev.key === 'PageUp') {\n\t\t\t\tdist = -dist;\n\t\t\t}\n\n\t\t\tif (modifiers === '' || modifiers === 's') {\n\t\t\t\tconst lineIndex = this.findCursorLineIndex();\n\t\t\t\tconst newIndex = Math.min(this.props.lines.length - 1, Math.max(0, lineIndex + dist));\n\t\t\t\tif (lineIndex !== newIndex) {\n\t\t\t\t\tthis.applySelection(ev, this.props.lines[newIndex]);\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t}\n\t\t\t} else if (ev.ctrlKey) {\n\t\t\t\tthis.props.applyScroll(dist);\n\t\t\t\tev.preventDefault();\n\t\t\t}\n\t\t}\n\n\t\tif ((ev.key === 'ArrowLeft' || ev.key === 'ArrowRight') && modifiers === '') {\n\t\t\tthis.props.followBranch(ev.key === 'ArrowRight', this.findCursorLine());\n\t\t\tev.preventDefault();\n\t\t}\n\n\t\tif (ev.key === 'Tab' && modifiers === '') {\n\t\t\tthis.props.updateDisplaySymbols(!this.props.displaySymbols);\n\t\t\tev.preventDefault();\n\t\t}\n\n\t\tif (ev.key === 'a' && modifiers === 'c') {\n\t\t\tthis.props.assembleInstruction(this.findCursorLine(), '');\n\t\t\tev.preventDefault();\n\t\t}\n\n\t\tif ((ev.key === ' ' || ev.key === 'Spacebar') && modifiers === '') {\n\t\t\tthis.props.toggleBreakpoint(this.findCursorLine());\n\t\t\tev.preventDefault();\n\t\t}\n\t\tif (ev.key === 'd' && modifiers === 'c') {\n\t\t\tthis.props.toggleBreakpoint(this.findCursorLine(), true);\n\t\t\tev.preventDefault();\n\t\t}\n\n\t\tif ((ev.key === 's' || ev.key === 'f') && modifiers === 'c') {\n\t\t\tthis.props.searchPrompt();\n\t\t\tev.preventDefault();\n\t\t}\n\n\t\tif ((ev.key === 'F3') && modifiers === '') {\n\t\t\tthis.props.searchNext();\n\t\t\tev.preventDefault();\n\t\t}\n\n\t\tif (ev.key === 'g' && modifiers === 'c') {\n\t\t\tthis.props.promptGoto();\n\t\t\tev.preventDefault();\n\t\t}\n\n\t\tif (ev.key === 'e' && modifiers === 'c') {\n\t\t\tthis.props.editBreakpoint(this.findCursorLine());\n\t\t\tev.preventDefault();\n\t\t}\n\t}\n\n\tapplySelection(ev, line) {\n\t\tlet { selectionTop, selectionBottom } = this.props;\n\t\tif (ev.shiftKey) {\n\t\t\tselectionTop = Math.min(selectionTop, line.address);\n\t\t\tselectionBottom = Math.max(selectionBottom, line.address);\n\t\t} else {\n\t\t\tselectionTop = line.address;\n\t\t\tselectionBottom = line.address;\n\t\t}\n\n\t\tif (selectionTop !== this.props.selectionTop || selectionBottom !== this.props.selectionBottom) {\n\t\t\tthis.props.updateSelection({\n\t\t\t\tselectionTop,\n\t\t\t\tselectionBottom,\n\t\t\t});\n\t\t}\n\t\tthis.props.updateCursor(line.address);\n\t}\n\n\tmouseEventToLine(ev) {\n\t\t// Account for page and list scrolling.\n\t\tconst y = ev.pageY - this.ref.current.getBoundingClientRect().top - window.pageYOffset;\n\t\tconst index = Math.floor(y / this.props.lineHeight);\n\t\treturn this.props.lines[index];\n\t}\n\n\tfindCursorLineIndex() {\n\t\tconst { cursor, lines, selectionTop } = this.props;\n\t\tconst addr = cursor ? cursor : selectionTop;\n\t\tfor (let i = 0; i < lines.length; ++i) {\n\t\t\tif (lines[i].address === addr) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tfindCursorLine() {\n\t\tconst lineIndex = this.findCursorLineIndex();\n\t\treturn this.props.lines[lineIndex];\n\t}\n}\n\nDisasmList.propTypes = {\n\tlineHeight: PropTypes.number.isRequired,\n\tvisibleLines: PropTypes.number.isRequired,\n\tdisplaySymbols: PropTypes.bool.isRequired,\n\tcursor: PropTypes.number,\n\tselectionTop: PropTypes.number,\n\tselectionBottom: PropTypes.number,\n\thighlightText: PropTypes.string,\n\n\tonDoubleClick: PropTypes.func.isRequired,\n\tupdateCursor: PropTypes.func.isRequired,\n\tupdateSelection: PropTypes.func.isRequired,\n\tupdateDisplaySymbols: PropTypes.func.isRequired,\n\tgetSelectedDisasm: PropTypes.func.isRequired,\n\tfollowBranch: PropTypes.func.isRequired,\n\tassembleInstruction: PropTypes.func.isRequired,\n\ttoggleBreakpoint: PropTypes.func.isRequired,\n\tapplyScroll: PropTypes.func.isRequired,\n\tpromptGoto: PropTypes.func.isRequired,\n\tsearchPrompt: PropTypes.func.isRequired,\n\tsearchNext: PropTypes.func.isRequired,\n\teditBreakpoint: PropTypes.func.isRequired,\n\n\trange: PropTypes.shape({\n\t\tstart: PropTypes.number.isRequired,\n\t\tend: PropTypes.number.isRequired,\n\t}).isRequired,\n\tlines: PropTypes.arrayOf(PropTypes.shape({\n\t\taddress: PropTypes.number.isRequired,\n\t})).isRequired,\n\tbranchGuides: PropTypes.arrayOf(PropTypes.shape({\n\t\ttop: PropTypes.number.isRequired,\n\t\tbottom: PropTypes.number.isRequired,\n\t\tdirection: PropTypes.string.isRequired,\n\t})).isRequired,\n};\n\nexport default DisasmList;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'clsx';\nimport './DisasmSearch.css';\n\nclass DisasmSearch extends PureComponent {\n\tref;\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.ref = React.createRef();\n\t}\n\n\trender() {\n\t\tconst value = this.props.searchString || '';\n\t\tconst classes = classNames('DisasmSearch__field', { 'DisasmSearch__field--progress': this.props.inProgress });\n\n\t\treturn (\n\t\t\t/* eslint no-script-url: \"off\" */\n\t\t\t<form action=\"#\" className=\"DisasmSearch\" hidden={this.props.searchString === null} onSubmit={this.handleNext}>\n\t\t\t\t<div className={classes}>\n\t\t\t\t\t<input type=\"search\" value={value} placeholder=\"Find...\" onChange={this.handleChange} onKeyDown={this.handleKeyDown} ref={this.ref} />\n\t\t\t\t</div>\n\t\t\t\t<button type=\"submit\">\n\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\" width=\"15\" height=\"15\" role=\"img\">\n\t\t\t\t\t\t<title>Search / Next</title>\n\t\t\t\t\t\t<path d=\"M10,50 l80,0 l-35,-40 m35,40 l-35,40\" />\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t\t<button type=\"button\" onClick={this.handleCancel}>\n\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 180 180\" width=\"15\" height=\"15\" role=\"img\">\n\t\t\t\t\t\t<title>Cancel</title>\n\t\t\t\t\t\t<path d=\"M30,30 l120,120 m-120,0 l120,-120\" />\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</form>\n\t\t);\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (prevProps.searchString === null && this.props.searchString !== null) {\n\t\t\tthis.focus();\n\t\t}\n\t}\n\n\thandleChange = (ev) => {\n\t\tthis.props.updateSearchString(ev.target.value);\n\t}\n\n\thandleNext = (ev) => {\n\t\tthis.props.searchNext();\n\t\tthis.focus();\n\t\tev.preventDefault();\n\t}\n\n\thandleCancel = (ev) => {\n\t\tthis.props.updateSearchString(null);\n\t}\n\n\thandleKeyDown = (ev) => {\n\t\tif (ev.key === 'Escape') {\n\t\t\tthis.handleCancel();\n\t\t\tev.preventDefault();\n\t\t}\n\t}\n\n\tfocus() {\n\t\tthis.ref.current.focus();\n\t}\n}\n\nDisasmSearch.propTypes = {\n\tsearchString: PropTypes.string,\n\tinProgress: PropTypes.bool.isRequired,\n\tupdateSearchString: PropTypes.func.isRequired,\n\tsearchNext: PropTypes.func.isRequired,\n};\n\nexport default DisasmSearch;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { toString02X, toString04X, toString08X } from '../../utils/format';\nimport './StatusBar.css';\n\nclass StatusBar extends PureComponent {\n\trender() {\n\t\tconst { line } = this.props;\n\t\tif (!line) {\n\t\t\treturn <div className=\"StatusBar\"></div>;\n\t\t}\n\n\t\treturn (\n\t\t\t<div className=\"StatusBar\">\n\t\t\t\t<div className=\"StatusBar__left\">{this.renderLeftStatus(line)}</div>\n\t\t\t\t<div className=\"StatusBar__right\">{line.function || line.symbol || ''}</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderLeftStatus(line) {\n\t\tif (line.type === 'opcode' || line.type === 'macro') {\n\t\t\tif (line.dataAccess) {\n\t\t\t\treturn this.renderDataAccess(line.dataAccess);\n\t\t\t} else if (line.branch) {\n\t\t\t\treturn this.renderBranch(line.branch);\n\t\t\t} else if (line.relevantData && typeof line.relevantData.stringValue === 'string') {\n\t\t\t\treturn this.renderString(line.relevantData);\n\t\t\t}\n\t\t} else if (line.type === 'data') {\n\t\t\treturn this.renderDataSymbol(line.dataSymbol, line.address);\n\t\t}\n\n\t\treturn '';\n\t}\n\n\trenderDataAccess(dataAccess) {\n\t\tif (dataAccess.uintValue === null) {\n\t\t\treturn 'Invalid address ' + toString08X(dataAccess.address);\n\t\t}\n\n\t\tlet status = '[' + toString08X(dataAccess.address) + '] = ';\n\t\tif (dataAccess.valueSymbol) {\n\t\t\tstatus += dataAccess.valueSymbol + ' (';\n\t\t}\n\t\tif (dataAccess.size === 1) {\n\t\t\tstatus += toString02X(dataAccess.uintValue);\n\t\t} else if (dataAccess.size === 2) {\n\t\t\tstatus += toString04X(dataAccess.uintValue);\n\t\t} else if (dataAccess.size >= 4) {\n\t\t\t// TODO: Show vectors better.\n\t\t\tstatus += toString08X(dataAccess.uintValue);\n\t\t}\n\t\tif (dataAccess.valueSymbol) {\n\t\t\tstatus += ')';\n\t\t}\n\n\t\treturn status;\n\t}\n\n\trenderBranch(branch) {\n\t\tlet status = branch.targetAddress ? toString08X(branch.targetAddress) : '';\n\t\tif (branch.symbol) {\n\t\t\tstatus += ' = ' + branch.symbol;\n\t\t}\n\t\treturn status;\n\t}\n\n\trenderString(data) {\n\t\treturn '[' + toString08X(data.address) + '] = ' + JSON.stringify(data.stringValue);\n\t}\n\n\trenderDataSymbol(dataSymbol, address) {\n\t\tlet status = toString08X(dataSymbol.start);\n\t\tif (dataSymbol.label) {\n\t\t\tstatus += ' (' + dataSymbol.label + ')';\n\t\t}\n\t\tif (address !== dataSymbol.start) {\n\t\t\tstatus += ' + ' + toString08X(dataSymbol.start - address);\n\t\t}\n\t\treturn status;\n\t}\n}\n\nStatusBar.propTypes = {\n\tline: PropTypes.object,\n};\n\nexport default StatusBar;\n","class Listeners {\n\tconstructor() {\n\t\tthis.changeCallbacks_ = [];\n\t\tthis.ppsspp_ = null;\n\t\tthis.connected_ = false;\n\t}\n\n\tinit(ppsspp) {\n\t\tthis.ppsspp_ = ppsspp;\n\t}\n\n\t// Change the active connection.\n\tchange(connected) {\n\t\tthis.connected_ = connected;\n\t\tfor (let callback of this.changeCallbacks_) {\n\t\t\tcallback(connected);\n\t\t}\n\t}\n\n\tonConnectionChange(callback) {\n\t\tthis.changeCallbacks_.push(callback);\n\t\treturn {\n\t\t\tremove: () => {\n\t\t\t\tconst index = this.changeCallbacks_.indexOf(callback);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tthis.changeCallbacks_.splice(index, 1);\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n\n\tonConnection(callback) {\n\t\tconst changeCallback = (connected) => {\n\t\t\tif (connected) {\n\t\t\t\tcallback(true);\n\t\t\t}\n\t\t};\n\t\tif (this.connected_) {\n\t\t\tcallback(true);\n\t\t}\n\n\t\treturn this.onConnectionChange(changeCallback);\n\t}\n\n\t// Listen for events (and re-register as necessary.)\n\tlisten(handlers) {\n\t\tlet result = [];\n\t\tfor (let name in handlers) {\n\t\t\tif (handlers.hasOwnProperty(name)) {\n\t\t\t\tlet listener;\n\t\t\t\tif (name === 'connection') {\n\t\t\t\t\tlistener = this.onConnection(handlers[name]);\n\t\t\t\t} else if (name === 'connection.change') {\n\t\t\t\t\tlistener = this.onConnectionChange(handlers[name]);\n\t\t\t\t} else {\n\t\t\t\t\tlistener = this.ppsspp_.listen(name, handlers[name]);\n\t\t\t\t}\n\t\t\t\tresult.push(listener);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tforget(listeners) {\n\t\tfor (let listener of listeners) {\n\t\t\tlistener.remove();\n\t\t}\n\t}\n}\n\nconst listeners = new Listeners();\nexport default listeners;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport BreakpointModal from './BreakpointModal';\nimport DisasmContextMenu from './DisasmContextMenu';\nimport DisasmList from './DisasmList';\nimport DisasmSearch from './DisasmSearch';\nimport StatusBar from './StatusBar';\nimport { toString08X } from '../../utils/format';\nimport listeners from '../../utils/listeners.js';\nimport './Disasm.css';\n\nconst MIN_BUFFER = 100;\nconst MAX_BUFFER = 500;\n\nclass Disasm extends PureComponent {\n\tstate = {\n\t\tlines: [],\n\t\tbranchGuides: [],\n\t\trange: { start: 0, end: 0 },\n\t\tlineHeight: 0,\n\t\tvisibleLines: 0,\n\t\tdisplaySymbols: true,\n\t\twantDisplaySymbols: true,\n\t\tcursor: null,\n\t\tsearchString: null,\n\t\tsearchInProgress: false,\n\t\thighlightText: null,\n\t\teditingBreakpoint: null,\n\t\tcreatingBreakpoint: null,\n\t};\n\tjumpStack = [];\n\tneedsScroll = false;\n\tneedsOffsetFix = false;\n\tupdatesCancel = false;\n\tupdatesSequence = Promise.resolve(null);\n\tlastSearch = null;\n\tref;\n\tlistRef;\n\tsearchRef;\n\tlisteners_;\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.ref = React.createRef();\n\t\tthis.listRef = React.createRef();\n\t\tthis.searchRef = React.createRef();\n\t}\n\n\trender() {\n\t\tconst events = {\n\t\t\tonScroll: ev => this.onScroll(ev),\n\t\t\tonDragStart: ev => ev.preventDefault(),\n\t\t};\n\n\t\tif (!this.props.started) {\n\t\t\treturn this.renderNotStarted();\n\t\t}\n\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t<div ref={this.ref} className=\"Disasm\" {...events}>\n\t\t\t\t\t<DisasmList ref={this.listRef} {...this.state}\n\t\t\t\t\t\tonDoubleClick={this.onDoubleClick}\n\t\t\t\t\t\tupdateSelection={this.props.updateSelection}\n\t\t\t\t\t\tpromptGoto={this.props.promptGoto}\n\t\t\t\t\t\tupdateCursor={this.updateCursor}\n\t\t\t\t\t\tupdateDisplaySymbols={this.updateDisplaySymbols}\n\t\t\t\t\t\tselectionTop={this.props.selectionTop}\n\t\t\t\t\t\tselectionBottom={this.props.selectionBottom}\n\t\t\t\t\t\tgetSelectedDisasm={this.getSelectedDisasm}\n\t\t\t\t\t\tfollowBranch={this.followBranch}\n\t\t\t\t\t\tassembleInstruction={this.assembleInstruction}\n\t\t\t\t\t\ttoggleBreakpoint={this.toggleBreakpoint}\n\t\t\t\t\t\teditBreakpoint={this.editBreakpoint}\n\t\t\t\t\t\tapplyScroll={this.applyScroll}\n\t\t\t\t\t\tsearchPrompt={this.searchPrompt}\n\t\t\t\t\t\tsearchNext={this.searchNext}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<StatusBar line={this.state.lines.find(l => l.address === this.state.cursor)} />\n\n\t\t\t\t{this.renderContextMenu()}\n\t\t\t\t<DisasmSearch ref={this.searchRef}\n\t\t\t\t\tsearchString={this.state.searchString}\n\t\t\t\t\tsearchNext={this.searchNext}\n\t\t\t\t\tupdateSearchString={this.updateSearchString}\n\t\t\t\t\tinProgress={this.state.searchInProgress}\n\t\t\t\t/>\n\t\t\t\t<BreakpointModal\n\t\t\t\t\tppsspp={this.props.ppsspp}\n\t\t\t\t\tcurrentThread={this.props.currentThread}\n\t\t\t\t\tisOpen={this.state.editingBreakpoint !== null || this.state.creatingBreakpoint !== null}\n\t\t\t\t\tonClose={this.closeEditBreakpoint}\n\t\t\t\t\tbreakpoint={this.state.editingBreakpoint}\n\t\t\t\t\tinitialOverrides={this.state.creatingBreakpoint}\n\t\t\t\t/>\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n\n\trenderNotStarted() {\n\t\treturn (\n\t\t\t<div className=\"Disasm--not-started\">\n\t\t\t\tWaiting for a game to start...\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderContextMenu() {\n\t\treturn <DisasmContextMenu\n\t\t\tppsspp={this.props.ppsspp}\n\t\t\tlog={this.props.log}\n\t\t\tstepping={this.props.stepping}\n\t\t\tcurrentThread={this.props.currentThread}\n\t\t\tgetSelectedLines={this.getSelectedLines}\n\t\t\tgetSelectedDisasm={this.getSelectedDisasm}\n\t\t\tfollowBranch={this.followBranch}\n\t\t\tassembleInstruction={this.assembleInstruction}\n\t\t\ttoggleBreakpoint={this.toggleBreakpoint}\n\t\t/>;\n\t}\n\n\tupdateCursor = (cursor) => {\n\t\tif (this.state.cursor !== cursor) {\n\t\t\tthis.needsScroll = 'nearest';\n\t\t\tthis.setState({ cursor });\n\n\t\t\tthis.updatesSequence = this.updatesSequence.then(() => {\n\t\t\t\tif (this.updatesCancel) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tlet { start, end } = this.state.range;\n\t\t\t\tconst minBuffer = Math.max(MIN_BUFFER, this.state.visibleLines);\n\t\t\t\tconst maxBuffer = Math.max(MAX_BUFFER, this.state.visibleLines * 5);\n\n\t\t\t\t// This is here for keyboard scrolling, mainly.\n\t\t\t\tif (cursor - minBuffer * 4 < start) {\n\t\t\t\t\tstart = cursor - minBuffer * 2 * 4;\n\t\t\t\t} else if (cursor - maxBuffer * 4 > start) {\n\t\t\t\t\tstart = cursor - (maxBuffer - minBuffer) * 4;\n\t\t\t\t}\n\t\t\t\tif (cursor + minBuffer * 4 > end) {\n\t\t\t\t\tend = cursor + minBuffer * 2 * 4;\n\t\t\t\t} else if (cursor + maxBuffer * 4 < end) {\n\t\t\t\t\tend = cursor + (maxBuffer - minBuffer) * 4;\n\t\t\t\t}\n\n\t\t\t\tif (start !== this.state.range.start || end !== this.state.range.end) {\n\t\t\t\t\treturn this.updateDisasmNow('nearest', { address: start, end });\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t});\n\t\t}\n\t}\n\n\tgetSelectedLines = () => {\n\t\tconst { selectionTop, selectionBottom } = this.props;\n\t\tconst isSelected = line => line.address + line.addressSize > selectionTop && line.address <= selectionBottom;\n\t\treturn this.state.lines.filter(isSelected);\n\t}\n\n\tgetSelectedDisasm = () => {\n\t\tconst lines = this.getSelectedLines();\n\n\t\t// Gather all branch targets without labels.\n\t\tlet branchAddresses = {};\n\t\tconst unlabeledBranches = lines.map(l => l.branch).filter(b => b && !b.symbol && b.targetAddress);\n\t\tfor (const b of unlabeledBranches) {\n\t\t\tbranchAddresses[b.targetAddress] = 'pos_' + toString08X(b.targetAddress);\n\t\t}\n\n\t\tlet result = '';\n\t\tlet firstLine = true;\n\t\tfor (const l of lines) {\n\t\t\tconst label = l.symbol || branchAddresses[l.address];\n\t\t\tif (label) {\n\t\t\t\tif (!firstLine) {\n\t\t\t\t\tresult += '\\n';\n\t\t\t\t}\n\t\t\t\tresult += label + ':\\n\\n';\n\t\t\t}\n\n\t\t\tresult += '\\t' + l.name + ' ';\n\t\t\tif (l.branch && l.branch.targetAddress && !l.branch.symbol) {\n\t\t\t\t// Use the generated label.\n\t\t\t\tresult += l.params.replace(/0x[0-9A-f]+/, branchAddresses[l.branch.targetAddress]);\n\t\t\t} else {\n\t\t\t\tresult += l.params;\n\t\t\t}\n\t\t\tresult += '\\n';\n\n\t\t\tfirstLine = false;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tupdateDisplaySymbols = (flag) => {\n\t\tthis.setState({ wantDisplaySymbols: flag });\n\t}\n\n\tfollowBranch = (direction, line) => {\n\t\tif (direction) {\n\t\t\tlet target = line.branch && line.branch.targetAddress;\n\t\t\tif (target === null) {\n\t\t\t\ttarget = line.relevantData && line.relevantData.address;\n\t\t\t}\n\t\t\tif (target !== null) {\n\t\t\t\tthis.jumpStack.push(this.state.cursor);\n\t\t\t\tthis.gotoAddress(target);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.jumpStack.length !== 0) {\n\t\t\t\tthis.gotoAddress(this.jumpStack.pop());\n\t\t\t} else {\n\t\t\t\tthis.gotoAddress(this.props.pc);\n\t\t\t}\n\t\t}\n\t}\n\n\tassembleInstruction = (line, startCode) => {\n\t\tconst { address } = line;\n\t\tconst code = prompt('Assemble instruction', startCode);\n\t\tif (!code) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\tconst writeInstruction = () => {\n\t\t\treturn this.props.ppsspp.send({\n\t\t\t\tevent: 'memory.assemble',\n\t\t\t\taddress: address,\n\t\t\t\tcode,\n\t\t\t}).then(() => {\n\t\t\t\tif (address === this.state.cursor) {\n\t\t\t\t\t// Okay, move one down so we can fire 'em off.\n\t\t\t\t\tconst lineIndex = this.state.lines.indexOf(line);\n\t\t\t\t\tif (lineIndex < this.state.lines.length - 1) {\n\t\t\t\t\t\tconst nextAddress = this.state.lines[lineIndex + 1].address;\n\t\t\t\t\t\tthis.gotoAddress(nextAddress, 'nearest');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Now, whether we moved or not, also update disasm.\n\t\t\t\tthis.updateDisasm();\n\t\t\t});\n\t\t};\n\n\t\t// Check if this is actually a register assignment.\n\t\tconst assignment = code.split(/\\s*=\\s*(.+)$/, 2);\n\t\tif (assignment.length >= 2) {\n\t\t\treturn this.props.ppsspp.send({\n\t\t\t\tevent: 'cpu.evaluate',\n\t\t\t\tthread: this.props.currentThread,\n\t\t\t\texpression: assignment[1],\n\t\t\t}).then((result) => {\n\t\t\t\treturn this.props.ppsspp.send({\n\t\t\t\t\tevent: 'cpu.setReg',\n\t\t\t\t\tthread: this.props.currentThread,\n\t\t\t\t\tname: assignment[0],\n\t\t\t\t\tvalue: result.uintValue,\n\t\t\t\t});\n\t\t\t}).then(({ uintValue }) => {\n\t\t\t\tthis.props.log('Updated ' + assignment[0] + ' to ' + toString08X(uintValue));\n\t\t\t}, writeInstruction);\n\t\t} else {\n\t\t\treturn writeInstruction();\n\t\t}\n\t}\n\n\ttoggleBreakpoint = (line, keep) => {\n\t\tif (line.breakpoint === null) {\n\t\t\tthis.props.ppsspp.send({\n\t\t\t\tevent: 'cpu.breakpoint.add',\n\t\t\t\taddress: line.address,\n\t\t\t\tenabled: true,\n\t\t\t});\n\t\t} else if (!line.breakpoint.enabled) {\n\t\t\tthis.props.ppsspp.send({\n\t\t\t\tevent: 'cpu.breakpoint.update',\n\t\t\t\taddress: line.breakpoint.address || line.address,\n\t\t\t\tenabled: true,\n\t\t\t});\n\t\t} else if (keep) {\n\t\t\tthis.props.ppsspp.send({\n\t\t\t\tevent: 'cpu.breakpoint.update',\n\t\t\t\taddress: line.breakpoint.address || line.address,\n\t\t\t\tenabled: false,\n\t\t\t});\n\t\t} else {\n\t\t\tif (line.breakpoint.condition !== null) {\n\t\t\t\tif (!window.confirm('This breakpoint has has a condition.\\n\\nAre you sure you want to remove it?')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.props.ppsspp.send({\n\t\t\t\tevent: 'cpu.breakpoint.remove',\n\t\t\t\taddress: line.breakpoint.address || line.address,\n\t\t\t});\n\t\t}\n\t}\n\n\teditBreakpoint = (line) => {\n\t\t// In case it's actually in the middle of a macro.\n\t\tconst breakpointAddress = line.breakpoint?.address || line.address;\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'cpu.breakpoint.list',\n\t\t\taddress: breakpointAddress,\n\t\t\tenabled: true,\n\t\t}).then(({ breakpoints }) => {\n\t\t\tconst bp = breakpoints.find(bp => bp.address === breakpointAddress);\n\t\t\tif (bp) {\n\t\t\t\tconst editingBreakpoint = { ...bp, type: 'execute' };\n\t\t\t\tthis.setState({ editingBreakpoint });\n\t\t\t} else {\n\t\t\t\tconst creatingBreakpoint = { address: breakpointAddress, type: 'execute' };\n\t\t\t\tthis.setState({ creatingBreakpoint });\n\t\t\t}\n\t\t});\n\t}\n\n\tcloseEditBreakpoint = () => {\n\t\tthis.setState({ editingBreakpoint: null, creatingBreakpoint: null });\n\t}\n\n\tgotoAddress = (addr, snap = 'center') => {\n\t\tthis.needsScroll = snap;\n\t\tthis.props.updateSelection({\n\t\t\tselectionTop: addr,\n\t\t\tselectionBottom: addr,\n\t\t});\n\t}\n\n\tsearchDisasm = (cont) => {\n\t\tconst continueLast = cont && this.lastSearch !== null;\n\t\tconst { cursor, searchString } = this.state;\n\t\tif (!continueLast && !searchString) {\n\t\t\t// Prompt for a term so we can even do this.\n\t\t\tthis.searchPrompt();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.state.searchInProgress) {\n\t\t\tif (continueLast) {\n\t\t\t\t// Already doing that, silly.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.searchCancel();\n\t\t}\n\n\t\tif (!continueLast) {\n\t\t\tthis.lastSearch = {\n\t\t\t\tmatch: searchString,\n\t\t\t\tend: cursor,\n\t\t\t\tlast: null,\n\t\t\t};\n\t\t}\n\n\t\t// Set a new object so we can detect cancel uniquely.\n\t\tconst cancelState = { cancel: false };\n\t\tthis.lastSearch.cancelState = cancelState;\n\t\tthis.setState({ searchInProgress: true });\n\n\t\tconst { match, end, last } = this.lastSearch;\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'memory.searchDisasm',\n\t\t\taddress: cursor === last ? cursor + 4 : cursor,\n\t\t\tend,\n\t\t\tmatch,\n\t\t}).then(({ address }) => {\n\t\t\tif (cancelState.cancel) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.lastSearch) {\n\t\t\t\tthis.lastSearch.last = address;\n\t\t\t}\n\n\t\t\tif (address !== null) {\n\t\t\t\tthis.gotoAddress(address);\n\t\t\t} else if (cursor !== end) {\n\t\t\t\twindow.alert('Reached the starting point of the search');\n\t\t\t\tthis.gotoAddress(end);\n\t\t\t} else {\n\t\t\t\twindow.alert('The specified text was not found:\\n\\n' + match);\n\t\t\t}\n\t\t}).finally(() => {\n\t\t\tif (!cancelState.cancel) {\n\t\t\t\tthis.setState({ searchInProgress: false });\n\t\t\t\tif (this.lastSearch) {\n\t\t\t\t\tthis.lastSearch.cancelState = null;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateSearchString = (match) => {\n\t\tconst highlightText = match ? match.toLowerCase() : null;\n\t\tthis.setState({ highlightText, searchString: match });\n\t\tif (this.lastSearch && this.lastSearch.match !== match) {\n\t\t\t// Clear the search start position when changing the search.\n\t\t\tthis.searchCancel();\n\t\t\tthis.lastSearch = null;\n\t\t}\n\n\t\tif (match === null) {\n\t\t\t// Return focus to list.\n\t\t\tif (this.listRef.current) {\n\t\t\t\tthis.listRef.current.ensureCursorInView(false);\n\t\t\t}\n\t\t}\n\t}\n\n\tsearchPrompt = () => {\n\t\tthis.updateSearchString(this.state.searchString || (this.lastSearch ? this.lastSearch.match : ''));\n\t\tthis.searchRef.current.focus();\n\t}\n\n\tsearchNext = () => {\n\t\tthis.searchDisasm(true);\n\t}\n\n\tsearchCancel = () => {\n\t\tif (this.lastSearch && this.lastSearch.cancelState) {\n\t\t\tthis.lastSearch.cancelState.cancel = true;\n\t\t\tthis.setState({ searchInProgress: false });\n\t\t\tthis.lastSearch.cancelState = null;\n\t\t}\n\t}\n\n\tgetSnapshotBeforeUpdate(prevProps, prevState) {\n\t\tif (this.needsOffsetFix && this.listRef.current && this.state.lines.length !== 0) {\n\t\t\tconst { lines } = this.state;\n\t\t\tconst centerAddress = lines[Math.floor(lines.length / 2)].address;\n\t\t\tconst top = this.listRef.current.addressBoundingTop(centerAddress);\n\t\t\tif (top) {\n\t\t\t\treturn { top, centerAddress };\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.listeners_ = listeners.listen({\n\t\t\t'connection': () => {\n\t\t\t\tif (this.props.started) {\n\t\t\t\t\tthis.updateDisasm('center');\n\t\t\t\t}\n\t\t\t},\n\t\t\t'cpu.stepping': () => {\n\t\t\t\tconst hasRange = this.state.range.start !== 0 || this.state.range.end !== 0;\n\t\t\t\tthis.updateDisasm(hasRange ? 'nearest' : 'center');\n\t\t\t},\n\t\t\t'cpu.setReg': (result) => {\n\t\t\t\t// Need to re-render if pc is changed.\n\t\t\t\tif (result.category === 0 && result.register === 32) {\n\t\t\t\t\tthis.updateDisasm('center');\n\t\t\t\t}\n\t\t\t},\n\t\t\t'cpu.breakpoint.add': () => {\n\t\t\t\tthis.updateDisasm();\n\t\t\t},\n\t\t\t'cpu.breakpoint.update': () => {\n\t\t\t\tthis.updateDisasm();\n\t\t\t},\n\t\t\t'cpu.breakpoint.remove': () => {\n\t\t\t\tthis.updateDisasm();\n\t\t\t},\n\t\t});\n\t\tthis.updatesCancel = false;\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.searchCancel();\n\t\tthis.updatesCancel = true;\n\t\tlisteners.forget(this.listeners_);\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tconst { selectionTop, selectionBottom } = this.props;\n\t\tconst { range, lineHeight } = this.state;\n\n\t\tlet disasmChange = null, updateDisasmRange = null;\n\t\tif (this.state.wantDisplaySymbols !== prevState.wantDisplaySymbols) {\n\t\t\t// Keep the existing range, just update.\n\t\t\tdisasmChange = false;\n\t\t}\n\t\tif (this.props.currentThread !== prevProps.currentThread) {\n\t\t\tdisasmChange = false;\n\t\t}\n\t\tif (selectionTop !== prevProps.selectionTop || selectionBottom !== prevProps.selectionBottom) {\n\t\t\tif (selectionTop < range.start || selectionBottom >= range.end) {\n\t\t\t\tdisasmChange = 'center';\n\t\t\t\tupdateDisasmRange = true;\n\t\t\t}\n\t\t}\n\t\tif (!disasmChange && !prevProps.setInitialPC && this.props.setInitialPC) {\n\t\t\tdisasmChange = 'center';\n\t\t\tupdateDisasmRange = true;\n\t\t}\n\t\tif (disasmChange !== null && this.props.setInitialPC) {\n\t\t\tthis.updateDisasm(disasmChange, updateDisasmRange);\n\t\t}\n\n\t\tif (lineHeight === 0) {\n\t\t\tconst foundLine = document.querySelector('.DisasmLine');\n\t\t\tif (foundLine) {\n\t\t\t\t// Defer for other updates.\n\t\t\t\tsetTimeout(() => this.setState({ lineHeight: foundLine.getBoundingClientRect().height }), 0);\n\t\t\t}\n\t\t} else if (this.ref.current) {\n\t\t\tconst visibleLines = Math.floor(this.ref.current.clientHeight / lineHeight);\n\t\t\tif (visibleLines !== this.state.visibleLines) {\n\t\t\t\tthis.setState({ visibleLines });\n\t\t\t}\n\t\t}\n\n\t\tif (this.props.jumpMarker !== prevProps.jumpMarker) {\n\t\t\tthis.needsScroll = 'center';\n\t\t}\n\t\t// Always associated with a state update.\n\t\tif (this.needsScroll && this.listRef.current) {\n\t\t\tconst list = this.listRef.current;\n\t\t\tsetTimeout(() => {\n\t\t\t\tlist.ensureCursorInView(this.needsScroll);\n\t\t\t\tthis.needsScroll = false;\n\t\t\t}, 0);\n\t\t}\n\n\t\tif (snapshot && this.listRef.current) {\n\t\t\tconst top = this.listRef.current.addressBoundingTop(snapshot.centerAddress);\n\t\t\tthis.ref.current.scrollTop -= snapshot.top - top;\n\t\t\tthis.needsOffsetFix = false;\n\t\t}\n\t}\n\n\tupdateDisasm(needsScroll, newRange) {\n\t\tthis.updatesSequence = this.updatesSequence.then(() => {\n\t\t\tif (this.updatesCancel) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn this.updateDisasmNow(needsScroll, newRange);\n\t\t});\n\t}\n\n\tupdateDisasmNow(needsScroll, newRange = null) {\n\t\tif (!this.props.setInitialPC) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\tconst { range, visibleLines, wantDisplaySymbols: displaySymbols } = this.state;\n\t\tlet updateRange = newRange;\n\t\tif (newRange === true || (newRange === null && range.start === 0 && range.end === 0)) {\n\t\t\tconst minBuffer = Math.max(MIN_BUFFER, visibleLines);\n\t\t\tconst defaultBuffer = Math.floor(minBuffer * 1.5);\n\t\t\tupdateRange = {\n\t\t\t\taddress: this.props.selectionTop - defaultBuffer * 4,\n\t\t\t\tcount: defaultBuffer * 2,\n\t\t\t};\n\t\t} else if (newRange === null) {\n\t\t\tupdateRange = {\n\t\t\t\taddress: range.start,\n\t\t\t\tend: range.end,\n\t\t\t};\n\t\t}\n\n\t\treturn Promise.resolve(null).then(() => {\n\t\t\treturn this.props.ppsspp.send({\n\t\t\t\tevent: 'memory.disasm',\n\t\t\t\tthread: this.props.currentThread,\n\t\t\t\t...updateRange,\n\t\t\t\tdisplaySymbols,\n\t\t\t}).then((data) => {\n\t\t\t\tif (this.updatesCancel) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { range, branchGuides, lines } = data;\n\t\t\t\tif (needsScroll) {\n\t\t\t\t\tthis.needsScroll = needsScroll;\n\t\t\t\t} else {\n\t\t\t\t\tthis.needsOffsetFix = true;\n\t\t\t\t}\n\t\t\t\tthis.setState({\n\t\t\t\t\trange,\n\t\t\t\t\tbranchGuides: this.cleanupBranchGuides(branchGuides),\n\t\t\t\t\tlines,\n\t\t\t\t\tdisplaySymbols,\n\t\t\t\t});\n\t\t\t}, (err) => {\n\t\t\t\tif (!this.updatesCancel) {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\trange: { start: 0, end: 0 },\n\t\t\t\t\t\tbranchGuides: [],\n\t\t\t\t\t\tlines: [],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tcleanupBranchGuides(branchGuides) {\n\t\t// TODO: Temporary (?) workaround for a bug with duplicate branch guides.\n\t\tconst unique = new Map();\n\t\tbranchGuides.forEach((guide) => {\n\t\t\tconst key = String(guide.top) + String(guide.bottom) + guide.direction;\n\t\t\tunique.set(key, guide);\n\t\t});\n\t\treturn [...unique.values()];\n\t}\n\n\tonDoubleClick = (ev, data) => {\n\t\tthis.toggleBreakpoint(data.line);\n\t}\n\n\tapplyScroll = (dist) => {\n\t\tthis.ref.current.scrollTop += dist * this.state.lineHeight;\n\t}\n\n\tonScroll(ev) {\n\t\tthis.updatesSequence = this.updatesSequence.then(() => {\n\t\t\tif (this.updatesCancel) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst { bufferTop, bufferBottom } = this.bufferRange();\n\t\t\tconst minBuffer = Math.max(MIN_BUFFER, this.state.visibleLines);\n\t\t\tconst maxBuffer = Math.max(MAX_BUFFER, this.state.visibleLines * 5);\n\t\t\tlet { start, end } = this.state.range;\n\n\t\t\tif (bufferTop < minBuffer) {\n\t\t\t\tstart -= minBuffer * 4;\n\t\t\t} else if (bufferTop > maxBuffer) {\n\t\t\t\tstart += Math.max(minBuffer, bufferTop - maxBuffer) * 4;\n\t\t\t}\n\n\t\t\tif (bufferBottom < minBuffer) {\n\t\t\t\tend += minBuffer * 4;\n\t\t\t} else if (bufferBottom > maxBuffer) {\n\t\t\t\tend -= Math.max(minBuffer, bufferBottom - maxBuffer) * 4;\n\t\t\t}\n\n\t\t\tif (start !== this.state.range.start || end !== this.state.range.end) {\n\t\t\t\treturn this.updateDisasmNow(false, { address: start, end });\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\t}\n\n\tbufferRange() {\n\t\tconst { scrollHeight, scrollTop, clientHeight } = this.ref.current;\n\t\tconst bufferTop = scrollTop / this.state.lineHeight;\n\t\tconst bufferBottom = (scrollHeight - scrollTop - clientHeight) / this.state.lineHeight;\n\t\tconst visibleEachDirection = Math.floor((this.state.visibleLines - 1) / 2);\n\n\t\treturn {\n\t\t\tbufferTop: bufferTop + visibleEachDirection,\n\t\t\tbufferBottom: bufferBottom + visibleEachDirection,\n\t\t};\n\t}\n\n\tstatic getDerivedStateFromProps(nextProps, prevState) {\n\t\tconst { selectionTop, selectionBottom } = nextProps;\n\t\tif (prevState.cursor < selectionTop || prevState.cursor > selectionBottom) {\n\t\t\tlet cursor = selectionTop;\n\t\t\tif (prevState.lines.length) {\n\t\t\t\t// Snap to in case we goto an address in the middle\n\t\t\t\tconst line = prevState.lines.find(l => l.address <= selectionTop && l.address + l.addressSize > selectionTop);\n\t\t\t\tcursor = line ? line.address : cursor;\n\t\t\t}\n\t\t\treturn { cursor };\n\t\t}\n\t\treturn null;\n\t}\n}\n\nDisasm.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n\tlog: PropTypes.func.isRequired,\n\tselectionTop: PropTypes.number,\n\tselectionBottom: PropTypes.number,\n\tstepping: PropTypes.bool.isRequired,\n\tstarted: PropTypes.bool.isRequired,\n\tpaused: PropTypes.bool.isRequired,\n\tpc: PropTypes.number,\n\tsetInitialPC: PropTypes.bool.isRequired,\n\tcurrentThread: PropTypes.number,\n\n\tupdateSelection: PropTypes.func.isRequired,\n\tpromptGoto: PropTypes.func.isRequired,\n};\n\nexport default Disasm;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport BreakpointModal from './BreakpointModal';\nimport listeners from '../../utils/listeners.js';\nimport './DisasmButtons.css';\n\nclass DisasmButtons extends PureComponent {\n\tstate = {\n\t\tbreakpointModalOpen: false,\n\t\tconnected: false,\n\t\tlastThread: '',\n\t\tthreads: [],\n\t};\n\tlisteners_;\n\n\trender() {\n\t\tconst disabled = !this.props.started || !this.props.stepping;\n\n\t\treturn (\n\t\t\t<div className=\"DisasmButtons\">\n\t\t\t\t<div className=\"DisasmButtons__group DisasmButtons__nav\">\n\t\t\t\t\t<button type=\"button\" onClick={this.props.showNavTray}>Nav</button>\n\t\t\t\t\t<span className=\"DisasmButtons__spacer\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"DisasmButtons__group\">\n\t\t\t\t\t<button type=\"button\" disabled={!this.props.started || this.props.paused} onClick={this.handleGoBreak}>\n\t\t\t\t\t\t{this.props.stepping || !this.props.started ? 'Go' : 'Break'}\n\t\t\t\t\t</button>\n\t\t\t\t\t<span className=\"DisasmButtons__spacer\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"DisasmButtons__group\">\n\t\t\t\t\t<button type=\"button\" disabled={disabled} onClick={this.handleStepInto}>Step Into</button>\n\t\t\t\t\t<button type=\"button\" disabled={disabled} onClick={this.handleStepOver}>Step Over</button>\n\t\t\t\t\t<button type=\"button\" disabled={disabled} onClick={this.handleStepOut}>Step Out</button>\n\t\t\t\t\t<span className=\"DisasmButtons__spacer\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"DisasmButtons__group\">\n\t\t\t\t\t<button type=\"button\" disabled={disabled} onClick={this.handleNextHLE}>Next HLE</button>\n\t\t\t\t\t<span className=\"DisasmButtons__spacer\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"DisasmButtons__group\">\n\t\t\t\t\t<button type=\"button\" onClick={this.handleBreakpointOpen} disabled={!this.props.started}>Breakpoint</button>\n\t\t\t\t\t<span className=\"DisasmButtons__spacer\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"DisasmButtons__group\">\n\t\t\t\t\t<span className=\"DisasmButtons__thread-list\">\n\t\t\t\t\t\tThread: {this.renderThreadList()}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\n\t\t\t\t<BreakpointModal\n\t\t\t\t\tppsspp={this.props.ppsspp}\n\t\t\t\t\tcurrentThread={this.props.currentThread}\n\t\t\t\t\tisOpen={this.state.breakpointModalOpen}\n\t\t\t\t\tonClose={this.handleBreakpointClose}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderThreadList() {\n\t\tif (this.state.threads.length === 0) {\n\t\t\treturn '(none)';\n\t\t}\n\t\treturn (\n\t\t\t<select onChange={this.handleThreadSelect} value={this.props.currentThread || this.state.lastThread}>\n\t\t\t\t{this.state.threads.map(thread => this.renderThread(thread))}\n\t\t\t</select>\n\t\t);\n\t}\n\n\trenderThread(thread) {\n\t\tconst classes = 'DisasmButtons__thread' + (thread.isCurrent ? ' DisasmButtons__thread--current' : '');\n\t\treturn (\n\t\t\t<option key={thread.id} value={thread.id} className={classes}>\n\t\t\t\t{thread.name}{thread.isCurrent ? ' (current)' : ''}\n\t\t\t</option>\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.listeners_ = listeners.listen({\n\t\t\t'connection.change': (connected) => this.setState({ connected }),\n\t\t\t'cpu.stepping': () => this.updateThreadList(true),\n\t\t});\n\t}\n\n\tcomponentWillUnmount() {\n\t\tlisteners.forget(this.listeners_);\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (!prevState.connected && this.state.connected) {\n\t\t\tthis.updateThreadList(this.props.currentThread === undefined);\n\t\t}\n\t}\n\n\tupdateThreadList(resetCurrentThread) {\n\t\tif (!this.state.connected) {\n\t\t\t// This avoids a duplicate update during initial connect.\n\t\t\treturn;\n\t\t}\n\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'hle.thread.list',\n\t\t}).then(({ threads }) => {\n\t\t\tthis.setState({ threads });\n\t\t\tif (resetCurrentThread) {\n\t\t\t\tconst currentThread = threads.find(th => th.isCurrent);\n\t\t\t\tif (currentThread && currentThread.id !== this.props.currentThread) {\n\t\t\t\t\tthis.props.updateCurrentThread(currentThread.id);\n\t\t\t\t}\n\t\t\t}\n\t\t}, () => {\n\t\t\tthis.setState({ threads: [] });\n\t\t});\n\t}\n\n\thandleGoBreak = () => {\n\t\tif (this.props.stepping) {\n\t\t\tthis.props.updateCurrentThread(undefined);\n\t\t}\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: this.props.stepping ? 'cpu.resume' : 'cpu.stepping',\n\t\t}).catch(() => {\n\t\t\t// Already logged, let's assume the parent will have marked it disconnected/not started by now.\n\t\t});\n\t}\n\n\thandleStepInto = () => {\n\t\tthis.props.updateCurrentThread(undefined);\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'cpu.stepInto',\n\t\t\tthread: this.props.currentThread,\n\t\t}).catch(() => {\n\t\t\t// Already logged, let's assume the parent will have marked it disconnected/not started by now.\n\t\t});\n\t}\n\n\thandleStepOver = () => {\n\t\tthis.props.updateCurrentThread(undefined);\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'cpu.stepOver',\n\t\t\tthread: this.props.currentThread,\n\t\t}).catch(() => {\n\t\t\t// Already logged, let's assume the parent will have marked it disconnected/not started by now.\n\t\t});\n\t}\n\n\thandleStepOut = () => {\n\t\tconst threadID = this.props.currentThread;\n\t\tthis.props.updateCurrentThread(undefined);\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'cpu.stepOut',\n\t\t\tthread: this.props.currentThread,\n\t\t}).catch(() => {\n\t\t\t// This might fail if they aren't inside a function call on this thread, so restore the thread.\n\t\t\tthis.props.updateCurrentThread(threadID);\n\t\t});\n\t}\n\n\thandleNextHLE = () => {\n\t\tthis.props.updateCurrentThread(undefined);\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'cpu.nextHLE',\n\t\t}).catch(() => {\n\t\t\t// Already logged, let's assume the parent will have marked it disconnected/not started by now.\n\t\t});\n\t}\n\n\thandleThreadSelect = (ev) => {\n\t\tconst currentThread = this.state.threads.find(th => th.id === Number(ev.target.value));\n\t\tif (currentThread) {\n\t\t\tthis.props.updateCurrentThread(currentThread.id, currentThread.pc);\n\t\t}\n\t}\n\n\thandleBreakpointOpen = () => {\n\t\tthis.setState({ breakpointModalOpen: true });\n\t}\n\n\thandleBreakpointClose = () => {\n\t\tthis.setState({ breakpointModalOpen: false });\n\t}\n\n\tstatic getDerivedStateFromProps(nextProps, prevState) {\n\t\tlet update = null;\n\t\tif (nextProps.currentThread && nextProps.currentThread !== prevState.lastThread) {\n\t\t\tupdate = { ...update, lastThread: nextProps.currentThread || '' };\n\t\t}\n\t\tif (nextProps.stepping || nextProps.started) {\n\t\t\tupdate = { ...update, connected: true };\n\t\t}\n\t\tif (!nextProps.started && prevState.threads.length) {\n\t\t\tupdate = { ...update, threads: [] };\n\t\t}\n\t\treturn update;\n\t}\n}\n\nDisasmButtons.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n\tstarted: PropTypes.bool.isRequired,\n\tpaused: PropTypes.bool.isRequired,\n\tstepping: PropTypes.bool.isRequired,\n\tcurrentThread: PropTypes.number,\n\tshowNavTray: PropTypes.func.isRequired,\n\n\tupdateCurrentThread: PropTypes.func.isRequired,\n};\n\nexport default DisasmButtons;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport './GotoBox.css';\n\nclass GotoBox extends PureComponent {\n\tstate = {\n\t\taddress: '',\n\t};\n\tref;\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.ref = React.createRef();\n\t}\n\n\trender() {\n\t\t/* eslint no-script-url: \"off\" */\n\t\tconst disabled = !this.props.started;\n\t\treturn (\n\t\t\t<form action=\"#\" className=\"GotoBox\" onSubmit={this.handleSubmit}>\n\t\t\t\t<label className=\"GotoBox__label\" htmlFor=\"GotoBox__address\">Go to:</label>\n\t\t\t\t<input ref={this.ref}\n\t\t\t\t\ttype=\"text\" id=\"GotoBox__address\"\n\t\t\t\t\tvalue={this.state.address} onChange={this.handleChange}\n\t\t\t\t\ttitle=\"Hexadecimal address or expression, enter to submit\"\n\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t/>\n\t\t\t\t<button type=\"button\" className=\"GotoBox__button\" onClick={this.handlePC} disabled={disabled}>PC</button>\n\t\t\t\t<button type=\"button\" className=\"GotoBox__button\" onClick={this.handleRA} disabled={disabled}>RA</button>\n\t\t\t</form>\n\t\t);\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (this.props.promptGotoMarker !== prevProps.promptGotoMarker) {\n\t\t\tthis.ref.current.focus();\n\t\t\tthis.ref.current.select();\n\t\t}\n\t}\n\n\tjumpToReg(name) {\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'cpu.getReg',\n\t\t\tname,\n\t\t}).then((result) => {\n\t\t\tif (this.props.started) {\n\t\t\t\tthis.props.gotoDisasm(result.uintValue);\n\t\t\t}\n\t\t});\n\t}\n\n\thandleChange = (ev) => {\n\t\tthis.setState({ address: ev.target.value });\n\t}\n\n\thandleSubmit = (ev) => {\n\t\tif (this.props.started) {\n\t\t\tthis.props.ppsspp.send({\n\t\t\t\tevent: 'cpu.evaluate',\n\t\t\t\tthread: this.props.currentThread,\n\t\t\t\texpression: this.state.address,\n\t\t\t}).then(({ uintValue }) => {\n\t\t\t\tif (this.props.started) {\n\t\t\t\t\tthis.props.gotoDisasm(uintValue);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tev.preventDefault();\n\t}\n\n\thandlePC = (ev) => {\n\t\tthis.jumpToReg('pc');\n\t}\n\n\thandleRA = (ev) => {\n\t\tthis.jumpToReg('ra');\n\t}\n}\n\nGotoBox.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n\tstarted: PropTypes.bool.isRequired,\n\tcurrentThread: PropTypes.number,\n\n\tgotoDisasm: PropTypes.func.isRequired,\n};\n\nexport default GotoBox;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { AutoSizer, List } from 'react-virtualized';\nimport listeners from '../../utils/listeners.js';\nimport 'react-virtualized/styles.css';\nimport './FuncList.css';\n\nclass FuncList extends PureComponent {\n\tstate = {\n\t\tconnected: false,\n\t\t// Lots of functions can take a while...\n\t\tloading: true,\n\t\trowHeight: null,\n\t\tfunctions: [],\n\t\tfilter: '',\n\t\tfilteredFunctions: [],\n\t};\n\tlisteners_;\n\n\trender() {\n\t\tconst { filter } = this.state;\n\t\treturn (\n\t\t\t<div className=\"FuncList\">\n\t\t\t\t<input type=\"search\" className=\"FuncList__search\" value={filter} onChange={this.handleFilter} />\n\t\t\t\t{this.renderList()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderList() {\n\t\tconst { filter, loading, rowHeight } = this.state;\n\t\tif (loading || !rowHeight) {\n\t\t\treturn <div className=\"FuncList__loading\">Loading...</div>;\n\t\t}\n\n\t\treturn (\n\t\t\t<div className=\"FuncList__listing\" onClick={this.handleClick}>\n\t\t\t\t<AutoSizer filter={filter}>{this.renderSizedList}</AutoSizer>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderSizedList = ({ height, width }) => {\n\t\tconst { filter, filteredFunctions, rowHeight } = this.state;\n\t\treturn (\n\t\t\t<List\n\t\t\t\theight={height}\n\t\t\t\trowHeight={rowHeight}\n\t\t\t\trowRenderer={this.renderFunc}\n\t\t\t\twidth={width}\n\t\t\t\trowCount={filteredFunctions.length}\n\t\t\t\tfilter={filter}\n\t\t\t/>\n\t\t);\n\t}\n\n\trenderFunc = ({ index, key, style }) => {\n\t\tconst func = this.state.filteredFunctions[index];\n\t\treturn (\n\t\t\t<div key={key + '-' + func.address} style={style}>\n\t\t\t\t<button type=\"button\" data-address={func.address}>{func.name}</button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.listeners_ = listeners.listen({\n\t\t\t'connection.change': (connected) => this.setState({ connected }),\n\t\t\t'game.start': () => this.updateList(),\n\t\t});\n\t\tif (this.state.connected) {\n\t\t\tthis.updateList();\n\t\t}\n\t\tif (!this.state.rowHeight) {\n\t\t\tsetTimeout(() => this.measureHeight(), 0);\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tlisteners.forget(this.listeners_);\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (!prevState.connected && this.state.connected) {\n\t\t\tthis.updateList();\n\t\t}\n\t\tif (!this.state.rowHeight) {\n\t\t\tsetTimeout(() => this.measureHeight(), 0);\n\t\t}\n\t}\n\n\tmeasureHeight() {\n\t\tconst node = document.querySelector('.FuncList__loading');\n\t\tif (node) {\n\t\t\tconst rowHeight = node.getBoundingClientRect().height;\n\t\t\tthis.setState({ rowHeight });\n\t\t}\n\t}\n\n\tupdateList() {\n\t\tif (!this.state.connected) {\n\t\t\t// This avoids a duplicate update during initial connect.\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.state.loading && this.state.functions.length === 0) {\n\t\t\tthis.setState({ loading: true });\n\t\t}\n\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'hle.func.list',\n\t\t}).then(({ functions }) => {\n\t\t\tfunctions.sort((a, b) => a.name.localeCompare(b.name));\n\t\t\tconst filteredFunctions = this.applyFilter(functions, this.state.filter);\n\t\t\tthis.setState({ functions, filteredFunctions, loading: false });\n\t\t}, () => {\n\t\t\tthis.setState({ functions: [], filteredFunctions: [], loading: false });\n\t\t});\n\t}\n\n\tapplyFilter(functions, filter) {\n\t\tif (filter === '') {\n\t\t\treturn functions;\n\t\t}\n\t\tconst match = filter.toLowerCase();\n\t\treturn functions.filter(func => func.name.toLowerCase().indexOf(match) !== -1);\n\t}\n\n\thandleFilter = (ev) => {\n\t\tconst filter = ev.target.value;\n\t\tconst filteredFunctions = this.applyFilter(this.state.functions, filter);\n\t\tthis.setState({ filter, filteredFunctions });\n\t}\n\n\thandleClick = (ev) => {\n\t\tconst { address } = ev.target.dataset;\n\t\tthis.props.gotoDisasm(Number(address));\n\t\tev.preventDefault();\n\t}\n\n\tstatic getDerivedStateFromProps(nextProps, prevState) {\n\t\tlet update = null;\n\t\tif (nextProps.started) {\n\t\t\tupdate = { ...update, connected: true };\n\t\t}\n\t\tif (!nextProps.started && prevState.functions.length) {\n\t\t\tupdate = { ...update, functions: [], filteredFunctions: [] };\n\t\t}\n\t\treturn update;\n\t}\n}\n\nFuncList.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n\tlog: PropTypes.func.isRequired,\n\tgotoDisasm: PropTypes.func.isRequired,\n};\n\nexport default FuncList;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { ContextMenuTrigger } from 'react-contextmenu';\nimport { toString08X } from '../../utils/format';\nimport { ensureInView, hasContextMenu } from '../../utils/dom';\nimport classNames from 'clsx';\n\nclass RegList extends PureComponent {\n\tstate = {\n\t\tcursor: 0,\n\t};\n\tcursorRef;\n\tneedsScroll = false;\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.cursorRef = React.createRef();\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<dl>\n\t\t\t\t{this.props.registerNames.map((name, reg) => {\n\t\t\t\t\treturn this.renderReg(name, reg);\n\t\t\t\t})}\n\t\t\t</dl>\n\t\t);\n\t}\n\n\trenderReg(name, reg) {\n\t\tconst mapData = (props) => {\n\t\t\treturn { cat: this.props.id, reg, value: this.format(reg) };\n\t\t};\n\t\tconst attributes = {\n\t\t\tonDoubleClick: (ev) => this.onDoubleClick(ev, mapData()),\n\t\t\tonMouseDown: (ev) => this.setState({ cursor: reg }),\n\t\t\tonKeyDown: (ev) => this.onKeyDown(ev),\n\t\t\ttabIndex: 0,\n\t\t};\n\t\tconst ddClasses = {\n\t\t\t'RegPanel__item--changed': this.changed(reg),\n\t\t\t'RegPanel__item--selected': this.state.cursor === reg,\n\t\t};\n\t\tconst ref = this.state.cursor === reg ? this.cursorRef : undefined;\n\n\t\treturn (\n\t\t\t<ContextMenuTrigger id={this.props.contextmenu} renderTag=\"a\" attributes={attributes} collect={mapData} holdToDisplay={-1} key={reg}>\n\t\t\t\t<dt>{name}</dt>\n\t\t\t\t<dd className={classNames(ddClasses)} ref={ref}>\n\t\t\t\t\t{this.format(reg)}\n\t\t\t\t</dd>\n\t\t\t</ContextMenuTrigger>\n\t\t);\n\t}\n\n\tformat(reg) {\n\t\tif (this.props.id === 0) {\n\t\t\treturn toString08X(this.props.uintValues[reg]);\n\t\t} else {\n\t\t\treturn this.props.floatValues[reg];\n\t\t}\n\t}\n\n\tchanged(reg) {\n\t\treturn this.props.uintValues[reg] !== this.props.uintValuesLast[reg];\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\t// Always associated with a state update.\n\t\tif (this.needsScroll && this.cursorRef.current) {\n\t\t\tconst triggerNode = this.cursorRef.current.parentNode;\n\t\t\tensureInView(triggerNode, { block: 'nearest' });\n\t\t\ttriggerNode.focus();\n\t\t\tthis.needsScroll = false;\n\t\t}\n\t}\n\n\tonDoubleClick = (ev, data) => {\n\t\tif (ev.button === 0) {\n\t\t\tthis.props.onDoubleClick(ev, data);\n\t\t}\n\t}\n\n\tonKeyDown(ev) {\n\t\tif (hasContextMenu()) {\n\t\t\treturn;\n\t\t}\n\t\tif (ev.key === 'ArrowUp' && this.state.cursor > 0) {\n\t\t\tthis.needsScroll = true;\n\t\t\tthis.setState({ cursor: this.state.cursor - 1 });\n\t\t\tev.preventDefault();\n\t\t}\n\t\tif (ev.key === 'ArrowDown' && this.state.cursor < this.props.registerNames.length - 1) {\n\t\t\tthis.needsScroll = true;\n\t\t\tthis.setState({ cursor: this.state.cursor + 1 });\n\t\t\tev.preventDefault();\n\t\t}\n\t}\n}\n\nRegList.propTypes = {\n\tid: PropTypes.number.isRequired,\n\tcontextmenu: PropTypes.string.isRequired,\n\tonDoubleClick: PropTypes.func.isRequired,\n\tregisterNames: PropTypes.arrayOf(PropTypes.string).isRequired,\n\tuintValues: PropTypes.arrayOf(PropTypes.number).isRequired,\n\tfloatValues: PropTypes.arrayOf(PropTypes.string).isRequired,\n\tuintValuesLast: PropTypes.arrayOf(PropTypes.number).isRequired,\n\tfloatValuesLast: PropTypes.arrayOf(PropTypes.string).isRequired,\n};\n\nexport default RegList;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { ContextMenu, MenuItem } from 'react-contextmenu';\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport RegList from './RegList';\nimport listeners from '../../utils/listeners.js';\nimport { copyText } from '../../utils/clipboard';\nimport './RegPanel.css';\nimport '../ext/react-contextmenu.css';\nimport '../ext/react-tabs.css';\n\nclass RegPanel extends PureComponent {\n\tstate = {\n\t\tcategories: [],\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<div id=\"RegPanel\">\n\t\t\t\t{this.renderTabs()}\n\t\t\t\t{this.renderContextMenu()}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderTabs() {\n\t\tconst { categories } = this.state;\n\t\t// Seems react-tabs is buggy when tabs are initially empty.\n\t\tif (categories.length === 0) {\n\t\t\treturn '';\n\t\t}\n\n\t\treturn (\n\t\t\t<Tabs>\n\t\t\t\t<TabList>\n\t\t\t\t\t{categories.map(c => <Tab key={c.id}>{c.name}</Tab>)}\n\t\t\t\t</TabList>\n\t\t\t\t{categories.map(c => (\n\t\t\t\t\t<TabPanel key={c.id}>\n\t\t\t\t\t\t<RegList contextmenu=\"reglist\" onDoubleClick={this.handleChangeReg} {...c} />\n\t\t\t\t\t</TabPanel>\n\t\t\t\t))}\n\t\t\t</Tabs>\n\t\t);\n\t}\n\n\trenderContextMenu() {\n\t\tconst disabled = !this.props.stepping;\n\t\treturn (\n\t\t\t<ContextMenu id=\"reglist\">\n\t\t\t\t<MenuItem onClick={this.handleViewMemory}>\n\t\t\t\t\tGo to in Memory View\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem onClick={this.handleViewDisassembly}>\n\t\t\t\t\tGo to in Disassembly\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem divider />\n\t\t\t\t<MenuItem onClick={this.handleCopyReg}>\n\t\t\t\t\tCopy Value\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem disabled={disabled} onClick={this.handleChangeReg}>\n\t\t\t\t\tChange...\n\t\t\t\t</MenuItem>\n\t\t\t</ContextMenu>\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.listeners_ = listeners.listen({\n\t\t\t'connection': () => this.updateRegs(false),\n\t\t\t'cpu.stepping': () => this.updateRegs(false),\n\t\t\t'cpu.setReg': (result) => this.updateReg(result),\n\t\t});\n\t}\n\n\tcomponentWillUnmount() {\n\t\tlisteners.forget(this.listeners_);\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (this.props.currentThread && this.props.currentThread !== prevProps.currentThread) {\n\t\t\tthis.updateRegs(true);\n\t\t}\n\t}\n\n\thandleViewMemory = (ev, data) => {\n\t\t// TODO\n\t\tconsole.log(data);\n\t}\n\n\thandleViewDisassembly = (ev, data) => {\n\t\tconst uintValue = this.state.categories[data.cat].uintValues[data.reg];\n\t\tthis.props.gotoDisasm(uintValue);\n\t}\n\n\thandleCopyReg = (ev, data, regNode) => {\n\t\tcopyText(data.value);\n\t}\n\n\thandleChangeReg = (ev, data, regNode) => {\n\t\tconst prevValue = (data.cat === 0 ? '0x' : '') + data.value;\n\t\tconst registerName = this.state.categories[data.cat].registerNames[data.reg];\n\n\t\tconst newValue = window.prompt('New value for ' + registerName, prevValue);\n\t\tif (newValue === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst packet = {\n\t\t\tevent: 'cpu.setReg',\n\t\t\tthread: this.props.currentThread,\n\t\t\tcategory: data.cat,\n\t\t\tregister: data.reg,\n\t\t\tvalue: newValue,\n\t\t};\n\n\t\t// The result is automatically listened for.\n\t\tthis.props.ppsspp.send(packet).catch((err) => {\n\t\t\twindow.alert(err);\n\t\t});\n\t}\n\n\tupdateRegs(keepLast) {\n\t\tthis.props.ppsspp.send({\n\t\t\tevent: 'cpu.getAllRegs',\n\t\t\tthread: this.props.currentThread,\n\t\t}).then((result) => {\n\t\t\tlet { categories } = result;\n\t\t\t// Add values for change tracking.\n\t\t\tconst hasPrev = this.state.categories.length !== 0;\n\t\t\tfor (let cat of categories) {\n\t\t\t\tconst prevCat = hasPrev ? this.state.categories[cat.id] : null;\n\t\t\t\tcat.uintValuesLast = hasPrev ? (keepLast ? prevCat.uintValuesLast : prevCat.uintValues) : cat.uintValues;\n\t\t\t\tcat.floatValuesLast = hasPrev ? (keepLast ? prevCat.floatValuesLast : prevCat.floatValues) : cat.floatValues;\n\t\t\t}\n\t\t\tthis.setState({ categories });\n\t\t}, (err) => {\n\t\t\t// Leave regs alone.\n\t\t\tconsole.error(err);\n\t\t});\n\t}\n\n\tupdateReg(result) {\n\t\tconst replaceCopy = (arr, index, item) => {\n\t\t\treturn arr.slice(0, index).concat([item]).concat(arr.slice(index + 1));\n\t\t};\n\n\t\tconst categories = this.state.categories.map((cat) => {\n\t\t\tif (cat.id === result.category) {\n\t\t\t\treturn {\n\t\t\t\t\t...cat,\n\t\t\t\t\t// Keep values from last time, until next stepping.\n\t\t\t\t\tuintValuesLast: cat.uintValuesLast,\n\t\t\t\t\tfloatValuesLast: cat.floatValuesLast,\n\t\t\t\t\tuintValues: replaceCopy(cat.uintValues, result.register, result.uintValue),\n\t\t\t\t\tfloatValues: replaceCopy(cat.floatValues, result.register, result.floatValue),\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn cat;\n\t\t});\n\n\t\tthis.setState({ categories });\n\t}\n}\n\nRegPanel.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n\tlog: PropTypes.func.isRequired,\n\tstepping: PropTypes.bool,\n\tgotoDisasm: PropTypes.func.isRequired,\n\tcurrentThread: PropTypes.number,\n};\n\nexport default RegPanel;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport FitModal from '../common/FitModal';\nimport listeners from '../../utils/listeners';\nimport { toString08X } from '../../utils/format';\nimport '../ext/react-modal.css';\nimport './VisualizeVFPU.css';\n\n// TODO: Consider using react-new-window for desktop?\n\nclass VisualizeVFPU extends PureComponent {\n\tstate = {\n\t\tcategories: [],\n\t\tformat: 'float',\n\t};\n\tlisteners_;\n\n\trender() {\n\t\tconst { categories, format } = this.state;\n\t\tif (categories.length < 3) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet matrices = [];\n\t\tfor (let m = 0; m < categories[2].uintValues.length / 16; ++m) {\n\t\t\tmatrices.push(this.renderMatrix(m));\n\t\t}\n\n\t\treturn (\n\t\t\t<FitModal contentLabel=\"VFPU\" isOpen={this.props.isOpen} onClose={this.props.onClose}>\n\t\t\t\t<h2>VFPU Registers</h2>\n\t\t\t\t<div className=\"VisualizeVFPU__list\">\n\t\t\t\t\t{matrices}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"VisualizeVFPU__format\">\n\t\t\t\t\tDisplay as:\n\t\t\t\t\t<label><input type=\"radio\" checked={format === 'float'} value=\"float\" onChange={this.handleFormat} /> Float</label>\n\t\t\t\t\t<label><input type=\"radio\" checked={format === 'uint'} value=\"uint\" onChange={this.handleFormat} /> Hex</label>\n\t\t\t\t</div>\n\t\t\t</FitModal>\n\t\t);\n\t}\n\n\trenderMatrix(m) {\n\t\treturn (\n\t\t\t<table className=\"VisualizeVFPU__matrix\" key={m}>\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th className=\"VisualizeVFPU__name\">M{m}00</th>\n\t\t\t\t\t\t<th className=\"VisualizeVFPU__row-header\">R{m}00</th>\n\t\t\t\t\t\t<th className=\"VisualizeVFPU__row-header\">R{m}01</th>\n\t\t\t\t\t\t<th className=\"VisualizeVFPU__row-header\">R{m}02</th>\n\t\t\t\t\t\t<th className=\"VisualizeVFPU__row-header\">R{m}03</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{this.renderColumn(m, 0)}\n\t\t\t\t\t{this.renderColumn(m, 1)}\n\t\t\t\t\t{this.renderColumn(m, 2)}\n\t\t\t\t\t{this.renderColumn(m, 3)}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t);\n\t}\n\n\trenderColumn(m, c) {\n\t\treturn (\n\t\t\t<tr key={c}>\n\t\t\t\t<th className=\"VisualizeVFPU__col-header\">C{m}{c}0</th>\n\t\t\t\t<td>{this.renderValue(m, c, 0)}</td>\n\t\t\t\t<td>{this.renderValue(m, c, 1)}</td>\n\t\t\t\t<td>{this.renderValue(m, c, 2)}</td>\n\t\t\t\t<td>{this.renderValue(m, c, 3)}</td>\n\t\t\t</tr>\n\t\t);\n\t}\n\n\trenderValue(m, c, r) {\n\t\tconst reg = m * 4 + c * 32 + r;\n\t\tconst cat = this.state.categories[2];\n\t\tif (this.state.format === 'uint') {\n\t\t\treturn toString08X(cat.uintValues[reg]);\n\t\t}\n\t\treturn cat.floatValues[reg];\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.listeners_ = listeners.listen({\n\t\t\t'cpu.getAllRegs': ({ categories }) => this.setState({ categories }),\n\t\t});\n\t}\n\n\tcomponentWillUnmount() {\n\t\tlisteners.forget(this.listeners_);\n\t}\n\n\thandleFormat = (ev) => {\n\t\tconst format = ev.target.value;\n\t\tthis.setState({ format });\n\t}\n}\n\nVisualizeVFPU.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n\tlog: PropTypes.func.isRequired,\n\tisOpen: PropTypes.bool.isRequired,\n\n\tonClose: PropTypes.func.isRequired,\n};\n\nexport default VisualizeVFPU;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport FuncList from './FuncList';\nimport RegPanel from './RegPanel';\nimport VisualizeVFPU from './VisualizeVFPU';\nimport './LeftPanel.css';\nimport '../ext/react-tabs.css';\n\nclass LeftPanel extends PureComponent {\n\tstate = {\n\t\tvfpuModalOpen: false,\n\t\t// These can be slow, so we want to prevent render until it's selected.\n\t\teverShownFuncs: false,\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"LeftPanel\">\n\t\t\t\t<Tabs onSelect={this.handleSelect}>\n\t\t\t\t\t<TabList>\n\t\t\t\t\t\t<Tab>Regs</Tab>\n\t\t\t\t\t\t<Tab>Funcs</Tab>\n\t\t\t\t\t\t<Tab>Tools</Tab>\n\t\t\t\t\t</TabList>\n\t\t\t\t\t<TabPanel forceRender={true}>\n\t\t\t\t\t\t<RegPanel {...this.props} />\n\t\t\t\t\t</TabPanel>\n\t\t\t\t\t<TabPanel forceRender={this.state.everShownFuncs}>\n\t\t\t\t\t\t<FuncList {...this.props} />\n\t\t\t\t\t</TabPanel>\n\t\t\t\t\t<TabPanel className=\"react-tabs__tab-panel LeftPanel__tools\">\n\t\t\t\t\t\t<button type=\"button\" onClick={this.handleVFPUOpen}>Visualize VFPU</button>\n\t\t\t\t\t</TabPanel>\n\t\t\t\t</Tabs>\n\n\t\t\t\t<VisualizeVFPU {...this.props} isOpen={this.state.vfpuModalOpen} onClose={this.handleVFPUClose} />\n\t\t\t</div>\n\t\t);\n\t}\n\n\thandleSelect = (index) => {\n\t\tif (index === 1 && !this.state.everShownFuncs) {\n\t\t\tthis.setState({ everShownFuncs: true });\n\t\t}\n\t}\n\n\thandleVFPUOpen = () => {\n\t\tthis.setState({ vfpuModalOpen: true });\n\t}\n\n\thandleVFPUClose = () => {\n\t\tthis.setState({ vfpuModalOpen: false });\n\t}\n}\n\nLeftPanel.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n\tlog: PropTypes.func.isRequired,\n\tstepping: PropTypes.bool,\n\tgotoDisasm: PropTypes.func.isRequired,\n\tcurrentThread: PropTypes.number,\n};\n\nexport default LeftPanel;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport Disasm from './CPU/Disasm';\nimport DisasmButtons from './CPU/DisasmButtons';\nimport GotoBox from './CPU/GotoBox';\nimport LeftPanel from './CPU/LeftPanel';\nimport listeners from '../utils/listeners.js';\nimport './CPU.css';\n\nclass CPU extends PureComponent {\n\tstate = {\n\t\tstepping: false,\n\t\tpaused: true,\n\t\tstarted: false,\n\t\tpc: 0,\n\t\tsetInitialPC: false,\n\t\t// Note: these are inclusive.\n\t\tselectionTop: null,\n\t\tselectionBottom: null,\n\t\tjumpMarker: null,\n\t\tpromptGotoMarker: null,\n\t\tlastTicks: 0,\n\t\tticks: 0,\n\t\tcurrentThread: undefined,\n\t\tnavTray: false,\n\t};\n\tlisteners_;\n\n\trender() {\n\t\tconst { paused, stepping, started, currentThread, navTray } = this.state;\n\t\tconst commonProps = { stepping: stepping && !paused, paused, started, currentThread };\n\t\tconst { selectionTop, selectionBottom, jumpMarker, pc, setInitialPC } = this.state;\n\t\tconst disasmProps = { ...commonProps, selectionTop, selectionBottom, jumpMarker, pc, setInitialPC };\n\n\t\treturn (\n\t\t\t<div id=\"CPU\">\n\t\t\t\t<div className={navTray ? 'CPU__pane CPU__pane--open' : 'CPU__pane'}>\n\t\t\t\t\t<button type=\"button\" onClick={this.hideNavTray} className=\"CPU__paneClose\">Close</button>\n\t\t\t\t\t<GotoBox ppsspp={this.props.ppsspp} {...commonProps} gotoDisasm={this.gotoDisasm} promptGotoMarker={this.state.promptGotoMarker} />\n\t\t\t\t\t<LeftPanel {...this.props} {...commonProps} gotoDisasm={this.gotoDisasm} />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"Disasm__container\">\n\t\t\t\t\t<DisasmButtons {...this.props} {...commonProps} updateCurrentThread={this.updateCurrentThread} showNavTray={this.showNavTray} />\n\t\t\t\t\t<Disasm {...this.props} {...disasmProps} updateSelection={this.updateSelection} promptGoto={this.promptGoto} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.listeners_ = listeners.listen({\n\t\t\t'connection': () => this.onConnection(),\n\t\t\t'connection.change': (connected) => this.onConnectionChange(connected),\n\t\t\t'cpu.stepping': (data) => this.onStepping(data),\n\t\t\t'cpu.resume': () => this.setState({ stepping: false }),\n\t\t\t'game.start': () => {\n\t\t\t\t// This may often not happen if the register list is visible.\n\t\t\t\tif (!this.state.setInitialPC) {\n\t\t\t\t\tthis.updateInitialPC();\n\t\t\t\t}\n\t\t\t\tthis.setState({ started: true, paused: false });\n\t\t\t},\n\t\t\t'game.quit': () => {\n\t\t\t\tthis.setState({\n\t\t\t\t\tstarted: false,\n\t\t\t\t\tstepping: false,\n\t\t\t\t\tpaused: true,\n\t\t\t\t\tpc: 0,\n\t\t\t\t\tsetInitialPC: false,\n\t\t\t\t\tcurrentThread: undefined,\n\t\t\t\t});\n\t\t\t},\n\t\t\t'game.pause': () => this.setState({ paused: true }),\n\t\t\t'game.resume': () => this.setState({ paused: false }),\n\t\t\t'cpu.setReg': (result) => {\n\t\t\t\tif (result.category === 0 && result.register === 32) {\n\t\t\t\t\tconst pc = result.uintValue;\n\t\t\t\t\tif (!this.state.setInitialPC) {\n\t\t\t\t\t\tthis.gotoDisasm(pc);\n\t\t\t\t\t}\n\t\t\t\t\tthis.setState({ pc, setInitialPC: pc !== 0 });\n\t\t\t\t}\n\t\t\t},\n\t\t\t'cpu.getAllRegs': (result) => {\n\t\t\t\tconst pc = result.categories[0].uintValues[32];\n\t\t\t\tif (!this.state.setInitialPC) {\n\t\t\t\t\tthis.gotoDisasm(pc);\n\t\t\t\t}\n\t\t\t\tthis.setState({ pc, setInitialPC: pc !== 0 });\n\t\t\t},\n\t\t});\n\t}\n\n\tcomponentWillUnmount() {\n\t\tlisteners.forget(this.listeners_);\n\t}\n\n\tonConnectionChange(connected) {\n\t\t// On any reconnect, assume paused until proven otherwise.\n\t\tthis.setState({ connected, started: false, stepping: false, paused: true });\n\t\tif (!connected) {\n\t\t\tthis.setState({ currentThread: undefined });\n\t\t}\n\t}\n\n\tonConnection() {\n\t\t// Update the status of this connection immediately too.\n\t\tthis.props.ppsspp.send({ event: 'cpu.status' }).then((result) => {\n\t\t\tconst { stepping, paused, pc, ticks } = result;\n\t\t\tconst started = pc !== 0 || stepping;\n\n\t\t\tif (!this.state.setInitialPC) {\n\t\t\t\tthis.gotoDisasm(pc);\n\t\t\t}\n\t\t\tthis.setState({ connected: true, started, stepping, paused, pc, setInitialPC: pc !== 0, ticks, lastTicks: ticks });\n\t\t}, (err) => {\n\t\t\tthis.setState({ stepping: false, paused: true });\n\t\t});\n\t}\n\n\tonStepping(data) {\n\t\tthis.setState({\n\t\t\tstepping: true,\n\t\t\tpc: data.pc,\n\t\t\tselectionTop: data.pc,\n\t\t\tselectionBottom: data.pc,\n\t\t\tlastTicks: this.state.ticks,\n\t\t\tticks: data.ticks,\n\t\t});\n\t}\n\n\tupdateSelection = (data) => {\n\t\tthis.setState(data);\n\t}\n\n\tgotoDisasm = (pc) => {\n\t\tthis.setState({\n\t\t\tselectionTop: pc,\n\t\t\tselectionBottom: pc,\n\t\t\t// It just matters that this is a new object.\n\t\t\tjumpMarker: {},\n\t\t});\n\t}\n\n\tpromptGoto = () => {\n\t\tthis.setState({\n\t\t\tpromptGotoMarker: {},\n\t\t});\n\t}\n\n\tupdateCurrentThread = (currentThread, pc) => {\n\t\tthis.setState({ currentThread, pc, setInitialPC: pc !== 0 });\n\t\tif (pc) {\n\t\t\tthis.gotoDisasm(pc);\n\t\t}\n\t}\n\n\tshowNavTray = () => {\n\t\tthis.setState({ navTray: true });\n\t}\n\n\thideNavTray = () => {\n\t\tthis.setState({ navTray: false });\n\t}\n\n\tupdateInitialPC = () => {\n\t\tthis.props.ppsspp.send({ event: 'cpu.getReg', name: 'pc' }).then(result => {\n\t\t\tconst pc = result.uintValue;\n\t\t\tif (!this.state.setInitialPC) {\n\t\t\t\tthis.gotoDisasm(pc);\n\t\t\t}\n\t\t\tthis.setState({ pc, setInitialPC: pc !== 0 });\n\t\t});\n\t}\n}\n\nCPU.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n\tlog: PropTypes.func.isRequired,\n};\n\nexport default CPU;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport listeners from '../utils/listeners.js';\nimport './GPU.css';\n\nclass GPU extends PureComponent {\n\tstate = {\n\t\tconnected: false,\n\t\tstarted: false,\n\t\tpaused: true,\n\t\trecording: false,\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<div id=\"GPU\">\n\t\t\t\t<div className=\"GPU__info\">\n\t\t\t\t\t{this.state.started && !this.state.paused ? 'Click below to generate a GE dump.  It will download as a file.' : 'Waiting for a game to start...'}\n\t\t\t\t</div>\n\t\t\t\t{this.state.started && !this.state.paused ? (\n\t\t\t\t\t<form className=\"GPU__form\" onSubmit={this.beginRecord}>\n\t\t\t\t\t\t<button disabled={this.state.recording}>{this.state.recording ? 'Recording...' : 'Record'}</button>\n\t\t\t\t\t</form>\n\t\t\t\t) : null}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.listeners_ = listeners.listen({\n\t\t\t'connection': () => this.onConnection(),\n\t\t\t'connection.change': (connected) => this.onConnectionChange(connected),\n\t\t\t'game.start': () => this.setState({ started: true, paused: false }),\n\t\t\t'game.quit': () => this.setState({ started: false, paused: true }),\n\t\t\t'game.pause': () => this.setState({ paused: true }),\n\t\t\t'game.resume': () => this.setState({ paused: false }),\n\t\t});\n\t}\n\n\tcomponentWillUnmount() {\n\t\tlisteners.forget(this.listeners_);\n\t}\n\n\tonConnectionChange(connected) {\n\t\t// On any reconnect, assume paused until proven otherwise.\n\t\tthis.setState({ connected, started: false, paused: true });\n\t}\n\n\tonConnection() {\n\t\t// Update the status of this connection immediately too.\n\t\tthis.props.ppsspp.send({ event: 'cpu.status' }).then((result) => {\n\t\t\tconst { stepping, paused, pc } = result;\n\t\t\tconst started = pc !== 0 || stepping;\n\n\t\t\tthis.setState({ connected: true, started, paused });\n\t\t}, (err) => {\n\t\t\tthis.setState({ paused: true });\n\t\t});\n\t}\n\n\tbeginRecord = (ev) => {\n\t\tthis.setState({ recording: true });\n\t\tthis.props.ppsspp.send({ event: 'gpu.record.dump' }).then(result => {\n\t\t\tvar a = document.createElement('a');\n\t\t\ta.setAttribute('download', 'recording.ppdmp');\n\t\t\ta.href = result.uri;\n\t\t\ta.hidden = true;\n\t\t\tdocument.body.appendChild(a);\n\t\t\ta.click();\n\t\t\tdocument.body.removeChild(a);\n\n\t\t\tthis.setState({ recording: false });\n\t\t});\n\t\tev.preventDefault();\n\t}\n}\n\nGPU.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n\tlog: PropTypes.func.isRequired,\n};\n\nexport default GPU;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'clsx';\n\nclass LogItem extends PureComponent {\n\trender() {\n\t\tif (this.props.item.event === 'log') {\n\t\t\treturn this.formatLogEvent();\n\t\t}\n\n\t\treturn this.renderInternal();\n\t}\n\n\trenderInternal() {\n\t\treturn (\n\t\t\t<span className={this.makeClassName()}>\n\t\t\t\t{this.props.item.message}\n\t\t\t</span>\n\t\t);\n\t}\n\n\tformatLogEvent() {\n\t\tconst { item } = this.props;\n\t\treturn (\n\t\t\t<span className={this.makeClassName()}>\n\t\t\t\t<span className=\"Log__message__header\">\n\t\t\t\t\t<span className=\"Log__message__timestamp\">{item.timestamp}</span>\n\t\t\t\t\t{' ' + item.header + ' '}\n\t\t\t\t</span>\n\t\t\t\t{item.message}\n\t\t\t</span>\n\t\t);\n\t}\n\n\tmakeClassName() {\n\t\tconst { item } = this.props;\n\n\t\treturn classNames('Log__message', {\n\t\t\t'Log__message--internal': item.event !== 'log',\n\t\t\t['Log__message--channel-' + item.channel]: item.event === 'log',\n\t\t\t['Log__message--level-' + item.level]: true,\n\t\t});\n\t}\n}\n\nLogItem.propTypes = {\n\titem: PropTypes.shape({\n\t\tevent: PropTypes.string,\n\t\tchannel: PropTypes.string,\n\t\tlevel: PropTypes.number,\n\t\ttimestamp: PropTypes.string,\n\t\theader: PropTypes.string,\n\t\tmessage: PropTypes.string.isRequired,\n\t}).isRequired,\n};\n\nexport default LogItem;\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport LogItem from './LogItem';\nimport listeners from '../utils/listeners.js';\nimport './Log.css';\n\nconst MAX_LINES = 5000;\n\nclass Log extends PureComponent {\n\tstate = {\n\t\tid: 0,\n\t\titems: [],\n\t};\n\tdivRef;\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.divRef = React.createRef();\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div id=\"Log\" ref={this.divRef}>\n\t\t\t\t{this.state.items.map(this.renderItem.bind(this))}\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderItem(item) {\n\t\treturn <LogItem key={item.id} item={item} />;\n\t}\n\n\taddLogItem(newItem) {\n\t\tconst id = this.state.id + 1;\n\t\tconst itemWithId = { id, ...newItem };\n\t\tconst items = this.state.items.concat([itemWithId ]).slice(-MAX_LINES);\n\t\tthis.setState({\n\t\t\tid,\n\t\t\titems,\n\t\t});\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.ppsspp.onError = (message, level) => {\n\t\t\tconst newItem = { message: message + '\\n', level };\n\t\t\tthis.addLogItem(newItem);\n\t\t};\n\n\t\tthis.listeners_ = listeners.listen({\n\t\t\t'log': this.onLogEvent.bind(this),\n\t\t});\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState) {\n\t\tif (prevState.id !== this.state.id) {\n\t\t\tconst div = this.divRef.current;\n\t\t\tdiv.scrollTop = div.scrollHeight - div.clientHeight;\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tlisteners.forget(this.listeners_);\n\t}\n\n\tonLogEvent(data) {\n\t\tconst newItem = { ...data };\n\t\tthis.addLogItem(newItem);\n\t}\n}\n\nLog.propTypes = {\n\tppsspp: PropTypes.object.isRequired,\n};\n\nexport default Log;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './NotConnected.css';\n\nexport default function NotConnected(props) {\n\tconst connectManually = (ev) => {\n\t\tconst uri = ev.target.elements['debugger-uri'].value;\n\t\tprops.connect(uri);\n\t\tev.preventDefault();\n\t};\n\tconst connectAutomatically = (ev) => {\n\t\tprops.connect(null);\n\t\tev.preventDefault();\n\t};\n\n\treturn (\n\t\t<div id=\"NotConnected\">\n\t\t\t{props.connecting ? 'Connecting to PPSSPP...' : 'Not connected to PPSSPP'}\n\n\t\t\t<div className=\"NotConnected__info\">\n\t\t\t\tMake sure \"Allow remote debugger\" is enabled in Developer tools.\n\t\t\t</div>\n\t\t\t<form className=\"NotConnected__form\" onSubmit={connectManually}>\n\t\t\t\t<input type=\"text\" name=\"debugger-uri\" placeholder=\"ws://ip:port/debugger\" className=\"NotConnected__uri\" />\n\t\t\t\t<button disabled={props.connecting}>Connect Manually</button>\n\t\t\t</form>\n\t\t\t<form className=\"NotConnected__form\" onSubmit={connectAutomatically}>\n\t\t\t\t<button disabled={props.connecting}>Connect Automatically</button>\n\t\t\t</form>\n\t\t</div>\n\t);\n}\n\nNotConnected.propTypes = {\n\tconnect: PropTypes.func.isRequired,\n};\n","// PPSSPP debugger API client\n//\n// Most operations use promises and are asynchronous.\n//\n// Example usage:\n//\n//    let ppsspp = new PPSSPP();\n//    ppsspp.listen('cpu.stepping', function () {\n//        console.log('Hit a breakpoint');\n//    });\n//    ppsspp.autoConnect().then(function () {\n//        return ppsspp.send({ event: 'cpu.getReg', name: 'pc' });\n//    }).then(function (result) {\n//        console.log('pc: ', result.uintValue);\n//    }).catch(function (err) {\n//        console.log('Something went wrong', err);\n//    });\n//\n// Methods:\n//  - autoConnect(): Find and connect to PPSSPP automatically.  Returns a promise.\n//  - connect(uri): Connect to a specific WebSocket URI (begins with ws://.)  Returns a promise.\n//  - disconnect(): Disconnect from PPSSPP.  No return.\n//  - listen(name, handler): Adds a listener for unsolicited events (e.g. 'log') or '*' for all.  No return.\n//      The handler takes two parameter, the data object, and whether any previous handler returned true.\n//  - send(object): Send an event to PPSSPP.  Returns a promise resolving to the data object.\n//      Note that not all PPSSPP events have a response.  You may receive null or it may never resolve.\n//\n// Properties:\n//  - onError: Set this to a function receiving (message, level) for errors.\n//  - onClose: Set this to a function with no parameters called when on disconnect.\n//\n// For documentation on the actual events for send() and listen(), look in PPSSPP's source code.\n// Start with the comment in Core/Debugger/WebSocket.cpp.\n// Individual files in Core/Debugger/WebSocket/ also have comments describing the events and parameters.\n\n// We fast-resolve these to avoid confusion.\nconst NoResponseEvents = [\n\t'cpu.stepping',\n\t'cpu.resume',\n];\n\nconst ErrorLevels = {\n\tNOTICE: 1,\n\tERROR: 2,\n\tWARN: 3,\n\tINFO: 4,\n\tDEBUG: 5,\n\tVERBOSE: 6,\n};\n\nconst PPSSPP_MATCH_API = '//report.ppsspp.org/match/list';\nconst PPSSPP_SUB_PROTOCOL = 'debugger.ppsspp.org';\nconst PPSSPP_DEFAULT_PATH = '/debugger';\n\nexport default class PPSSPP {\n\tautoConnect() {\n\t\tif (this.socket_ !== null) {\n\t\t\treturn Promise.reject(new Error('Already connected, disconnect first'));\n\t\t}\n\n\t\tlet err = new Error('Couldn\\'t connect');\n\n\t\treturn fetch(PPSSPP_MATCH_API).then((response) => {\n\t\t\treturn response.json();\n\t\t}).then((listing) => {\n\t\t\treturn this.tryNextEndpoint_(listing);\n\t\t}).then(this.setupSocket_.bind(this), specificError => {\n\t\t\terr.message = specificError.message;\n\t\t\terr.originalError = specificError;\n\t\t\tthrow err;\n\t\t});\n\t}\n\n\tconnect(uri) {\n\t\tif (this.socket_ !== null) {\n\t\t\treturn Promise.reject(new Error('Already connected, disconnect first'));\n\t\t}\n\n\t\t// In case it fails, prepare the error (and stack trace) now.\n\t\tlet err = new Error('Couldn\\'t connect to ' + uri);\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst possibleSocket = new WebSocket(uri, PPSSPP_SUB_PROTOCOL);\n\n\t\t\tpossibleSocket.onopen = () => {\n\t\t\t\tthis.socket_ = possibleSocket;\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\tpossibleSocket.onclose = () => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t}).then(this.setupSocket_.bind(this));\n\t}\n\n\tdisconnect() {\n\t\tif (this.socket_ === null) {\n\t\t\tthrow new Error('Not connected');\n\t\t}\n\n\t\tthis.failAllPending_('Disconnected from PPSSPP');\n\n\t\tthis.socket_.close(1000);\n\t\tthis.socket_ = null;\n\t}\n\n\tlisten(eventName, handler) {\n\t\tif (!(eventName in this.listeners_)) {\n\t\t\tthis.listeners_[eventName] = [];\n\t\t}\n\n\t\tthis.listeners_[eventName].push(handler);\n\n\t\treturn {\n\t\t\tremove: () => {\n\t\t\t\tconst list = this.listeners_[eventName];\n\t\t\t\tconst index = list.indexOf(handler);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tlist.splice(index, 1);\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n\n\tsend(data) {\n\t\tif (this.socket_ === null) {\n\t\t\treturn Promise.reject(new Error('Not connected'));\n\t\t}\n\n\t\t// Prepare a stack trace now, not when resolving (since that will trace to the onmessage.)\n\t\tlet err = new Error('PPSSPP returned an error');\n\n\t\t// Avoid confusion by resolving immediately for known no-response events.\n\t\tif (NoResponseEvents.includes(data.event)) {\n\t\t\tthis.socket_.send(JSON.stringify(data));\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst ticket = this.makeTicket_();\n\n\t\t\tthis.pendingTickets_[ticket] = function (result) {\n\t\t\t\tif (result.event === 'error') {\n\t\t\t\t\terr.name = 'DebuggerError';\n\t\t\t\t\terr.message = result.message;\n\t\t\t\t\terr.originalMessage = result;\n\t\t\t\t\treject(err);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.socket_.send(JSON.stringify({ ...data, ticket }));\n\t\t});\n\t}\n\n\tsetupSocket_() {\n\t\tthis.socket_.onclose = () => {\n\t\t\tif (this.onClose) {\n\t\t\t\tthis.onClose();\n\t\t\t}\n\n\t\t\tthis.failAllPending_('PPSSPP disconnected');\n\t\t\tthis.socket_ = null;\n\t\t};\n\n\t\tthis.socket_.onmessage = (e) => {\n\t\t\ttry {\n\t\t\t\tconst data = JSON.parse(e.data);\n\n\t\t\t\tif (data.event === 'error') {\n\t\t\t\t\tthis.handleError_(data.message, data.level);\n\t\t\t\t}\n\n\t\t\t\tlet handled = false;\n\t\t\t\tif ('ticket' in data) {\n\t\t\t\t\thandled = this.handleTicket_(data.ticket, data);\n\t\t\t\t}\n\t\t\t\tthis.handleMessage_(data, handled);\n\t\t\t} catch (err) {\n\t\t\t\tthis.handleError_('Failed to parse message from PPSSPP: ' + err.message, ErrorLevels.ERROR);\n\t\t\t}\n\t\t};\n\t}\n\n\ttryNextEndpoint_(listing) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (!listing || listing.length === 0) {\n\t\t\t\treturn reject(new Error('Couldn\\'t connect automatically.  Is PPSSPP connected to the same network?'));\n\t\t\t}\n\n\t\t\tconst endpoint = 'ws://' + listing[0].ip + ':' + listing[0].p + PPSSPP_DEFAULT_PATH;\n\t\t\treturn this.connect(endpoint).then(resolve, err => {\n\t\t\t\tif (listing.length > 1) {\n\t\t\t\t\tresolve(this.tryNextEndpoint_(listing.slice(1)));\n\t\t\t\t} else {\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\thandleTicket_(ticket, data) {\n\t\tif (ticket in this.pendingTickets_) {\n\t\t\tconst handler = this.pendingTickets_[data.ticket];\n\t\t\tdelete this.pendingTickets_[data.ticket];\n\n\t\t\thandler(data);\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.handleError_('Received mismatched ticket: ' + JSON.stringify(data), ErrorLevels.ERROR);\n\t\treturn false;\n\t}\n\n\thandleMessage_(data, handled) {\n\t\thandled = this.executeHandlers_(data.event, data, handled);\n\t\tthis.executeHandlers_('*', data, handled);\n\t}\n\n\texecuteHandlers_(name, data, handled) {\n\t\tif (name in this.listeners_) {\n\t\t\tfor (let handler of this.listeners_[name]) {\n\t\t\t\tif (handler(data, handled)) {\n\t\t\t\t\thandled = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn handled;\n\t}\n\n\thandleError_(message, level) {\n\t\tif (this.onError) {\n\t\t\tthis.onError(message, level);\n\t\t} else if (level === undefined || Number(level) === ErrorLevels.ERROR) {\n\t\t\tconsole.error(message);\n\t\t} else {\n\t\t\tconsole.log(message);\n\t\t}\n\t}\n\n\tmakeTicket_() {\n\t\tlet ticket = Math.random().toString(36).substr(2);\n\t\tif (ticket in this.pendingTickets_) {\n\t\t\treturn this.makeTicket_();\n\t\t}\n\t\treturn ticket;\n\t}\n\n\tfailAllPending_(message) {\n\t\tconst data = { event: 'error', message, level: ErrorLevels.ERROR };\n\n\t\tfor (let ticket in this.pendingTickets_) {\n\t\t\tif (this.pendingTickets_.hasOwnProperty(ticket)) {\n\t\t\t\tthis.pendingTickets_[ticket](data);\n\t\t\t}\n\t\t}\n\t\tthis.pendingTickets_ = {};\n\t}\n\n\tonError = null;\n\tonClose = null;\n\n\tsocket_ = null;\n\tpendingTickets_ = {};\n\tlisteners_ = {};\n}\n\nexport { ErrorLevels };\n","export default __webpack_public_path__ + \"static/media/logo.94f885ce.svg\";","import React, { Component } from 'react';\nimport { NavLink, BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport CPU from './CPU';\nimport GPU from './GPU';\nimport Log from './Log';\nimport NotConnected from './NotConnected';\nimport PPSSPP from '../sdk/ppsspp.js';\nimport listeners from '../utils/listeners.js';\nimport logo from '../assets/logo.svg';\nimport './App.css';\n\nconst versionInfo = {\n\tname: process.env.REACT_APP_NAME,\n\tversion: process.env.REACT_APP_VERSION,\n};\n\nclass App extends Component {\n\tstate = {\n\t\tconnected: false,\n\t\tconnecting: false,\n\t};\n\tlogRef;\n\tppsspp;\n\toriginalTitle;\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.logRef = React.createRef();\n\t\tthis.ppsspp = new PPSSPP();\n\t\tthis.originalTitle = document.title;\n\n\t\tlisteners.init(this.ppsspp);\n\t\tlisteners.listen({\n\t\t\t'connection.change': this.onConnectionChange,\n\t\t\t'game.start': this.updateTitle,\n\t\t\t'game.quit': this.updateTitle,\n\t\t});\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Router>\n\t\t\t\t<div className=\"App\">\n\t\t\t\t\t<header className=\"App-header\">\n\t\t\t\t\t\t<ul className=\"App-nav\">\n\t\t\t\t\t\t\t<NavLink to=\"/cpu\">CPU</NavLink>\n\t\t\t\t\t\t\t<NavLink to=\"/gpu\">GPU</NavLink>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<img src={logo} className=\"App-logo\" alt=\"PPSSPP\" />\n\t\t\t\t\t\t<h1 className=\"App-title\">Debugger</h1>\n\t\t\t\t\t</header>\n\t\t\t\t\t{this.renderContent()}\n\t\t\t\t\t<Log ppsspp={this.ppsspp} ref={this.logRef} />\n\t\t\t\t</div>\n\t\t\t</Router>\n\t\t);\n\t}\n\n\trenderContent() {\n\t\tif (!this.state.connected) {\n\t\t\treturn <NotConnected connecting={this.state.connecting} connect={this.connect} />;\n\t\t}\n\n\t\treturn (\n\t\t\t<Switch>\n\t\t\t\t<Route path=\"/gpu\">\n\t\t\t\t\t<GPU ppsspp={this.ppsspp} log={this.log} />\n\t\t\t\t</Route>\n\t\t\t\t<Route>\n\t\t\t\t\t<CPU ppsspp={this.ppsspp} log={this.log} />\n\t\t\t\t</Route>\n\t\t\t</Switch>\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\t// Connect automatically on start.\n\t\tif (!this.props.testing) {\n\t\t\tthis.handleAutoConnect();\n\t\t}\n\t}\n\n\thandleAutoConnect = () => {\n\t\tthis.connect(null);\n\t}\n\n\tconnect = (uri) => {\n\t\tthis.setState({ connecting: true });\n\n\t\tthis.ppsspp.onClose = () => {\n\t\t\tthis.log('Debugger disconnected');\n\t\t\tlisteners.change(false);\n\t\t\tthis.setState({ connected: false, connecting: false });\n\t\t};\n\n\t\tlet connection;\n\t\tif (uri === null) {\n\t\t\tconnection = this.ppsspp.autoConnect();\n\t\t} else {\n\t\t\tconnection = this.ppsspp.connect(uri);\n\t\t}\n\n\t\tconnection.then(() => {\n\t\t\tthis.log('Debugger connected');\n\t\t\tlisteners.change(true);\n\t\t\tthis.setState({ connected: true, connecting: false });\n\t\t}, err => {\n\t\t\tthis.log('Debugger could not connect');\n\t\t\tlisteners.change(false);\n\t\t\tthis.setState({ connected: false, connecting: false });\n\t\t});\n\t}\n\n\thandleDisconnect = () => {\n\t\t// Should trigger the appropriate events automatically.\n\t\tthis.ppsspp.disconnect();\n\t}\n\n\tlog = (message) => {\n\t\t// Would rather keep Log managing its state, and pass this callback around.\n\t\tif (this.logRef.current) {\n\t\t\tthis.logRef.current.addLogItem({ message: message + '\\n' });\n\t\t} else {\n\t\t\tconsole.error(message);\n\t\t}\n\t}\n\n\tupdateTitle = (data) => {\n\t\tif (!document) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.game) {\n\t\t\tdocument.title = this.originalTitle + ' - ' + data.game.id + ': ' + data.game.title;\n\t\t} else {\n\t\t\tdocument.title = this.originalTitle;\n\t\t}\n\t}\n\n\tonConnectionChange = (status) => {\n\t\tif (status) {\n\t\t\tthis.ppsspp.send({ event: 'version', ...versionInfo }).catch((err) => {\n\t\t\t\twindow.alert('PPSSPP seems to think this debugger is out of date.  Try refreshing?\\n\\nDetails: ' + err);\n\t\t\t});\n\t\t\tthis.ppsspp.send({ event: 'game.status' }).then(this.updateTitle, (err) => this.updateTitle({}));\n\t\t} else {\n\t\t\tthis.updateTitle({});\n\t\t}\n\t}\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === 'localhost' ||\n\t\t// [::1] is the IPv6 localhost address.\n\t\twindow.location.hostname === '[::1]' ||\n\t\t// 127.0.0.1/8 is considered localhost for IPv4.\n\t\twindow.location.hostname.match(\n\t\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n\t\t)\n);\n\nexport default function register() {\n\tif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('load', () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Lets check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl);\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\n\t\t\t\t\t\t\t'worker. To learn more, visit https://goo.gl/SC7cgQ'\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Is not local host. Just register service worker\n\t\t\t\tregisterValidSW(swUrl);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction registerValidSW(swUrl) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then(registration => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing;\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === 'installed') {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the old content will have been purged and\n\t\t\t\t\t\t\t// the fresh content will have been added to the cache.\n\t\t\t\t\t\t\t// It's the perfect time to display a \"New content is\n\t\t\t\t\t\t\t// available; please refresh.\" message in your web app.\n\t\t\t\t\t\t\tconsole.log('New content is available; please refresh.');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.log('Content is cached for offline use.');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error('Error during service worker registration:', error);\n\t\t});\n}\n\nfunction checkValidServiceWorker(swUrl) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl)\n\t\t.then(response => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tif (\n\t\t\t\tresponse.status === 404 ||\n\t\t\t\tresponse.headers.get('content-type').indexOf('javascript') === -1\n\t\t\t) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl);\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.log(\n\t\t\t\t'No internet connection found. App is running in offline mode.'\n\t\t\t);\n\t\t});\n}\n\nexport function unregister() {\n\tif ('serviceWorker' in navigator) {\n\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\tregistration.unregister();\n\t\t});\n\t}\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Modal from 'react-modal';\nimport './index.css';\nimport App from './components/App';\nimport registerServiceWorker from './registerServiceWorker';\nimport 'core-js/stable';\nimport 'regenerator-runtime/runtime';\nimport 'react-app-polyfill/ie11';\nimport 'react-app-polyfill/stable';\n\nReactDOM.render(<App />, document.getElementById('root'));\nModal.setAppElement('#root');\nregisterServiceWorker();\n"],"sourceRoot":""}